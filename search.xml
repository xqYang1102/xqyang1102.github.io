<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>mybits的简单实例</title>
      <link href="/2021/02/18/210218_mybits-%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B/"/>
      <url>/2021/02/18/210218_mybits-%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><h2 id="一、初识Mybits"><a href="#一、初识Mybits" class="headerlink" title="一、初识Mybits"></a>一、初识<code>Mybits</code></h2><h3 id="1-什么是-MyBatis-？"><a href="#1-什么是-MyBatis-？" class="headerlink" title="1.什么是 MyBatis ？"></a>1.什么是 MyBatis ？</h3><p>MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p><h4 id="1-1-MyBatis的功能架构"><a href="#1-1-MyBatis的功能架构" class="headerlink" title="1.1 MyBatis的功能架构"></a>1.1 MyBatis的功能架构</h4><ol><li><p>API接口层：提供给外部使用的接口API，开发人员通过这些本地API来操纵数据库。接口层一接收到调用请求就会调用数据处理层来完成具体的数据处理。</p></li><li><p>数据处理层：负责具体的SQL查找、SQL解析、SQL执行和执行结果映射处理等。它主要的目的是根据调用的请求完成一次数据库操作。</p></li><li><p>基础支撑层：负责最基础的功能支撑，包括连接管理、事务管理、配置加载和缓存处理，这些都是共用的东西，将他们抽取出来作为最基础的组件。为上层的数据处理层提供最基础的支撑。 </p></li></ol><h4 id="1-2-优点"><a href="#1-2-优点" class="headerlink" title="1.2 优点"></a>1.2 优点</h4><ol><li><p>简单易学：本身就很小且简单。没有任何第三方依赖，最简单安装只要两个jar文件+配置几个sql映射文件易于学习，易于使用，通过文档和源代码，可以比较完全的掌握它的设计思路和实现</p></li><li><p>灵活：mybatis不会对应用程序或者数据库的现有设计强加任何影响。 sql写在xml里，便于统一管理和优化。通过sql基本上可以实现我们不使用数据访问框架可以实现的所有功能，或许更多</p></li><li><p>解除sql与程序代码的耦合：通过提供DAL层，将业务逻辑和数据访问逻辑分离，使系统的设计更清晰，更易维护，更易单元测试。sql和代码的分离，提高了可维护性</p></li><li><p>提供映射标签，支持对象与数据库的orm字段关系映射</p></li><li><p>提供对象关系映射标签，支持对象关系组建维护</p></li><li><p>提供xml标签，支持编写动态sql</p></li></ol><h4 id="1-3-缺点"><a href="#1-3-缺点" class="headerlink" title="1.3 缺点"></a>1.3 缺点</h4><ol><li><p>编写SQL语句时工作量很大，尤其是字段多、关联表多时，更是如此</p></li><li><p>SQL语句依赖于数据库，导致数据库移植性差，不能更换数据库</p></li><li><p>框架还是比较简陋，功能尚有缺失，虽然简化了数据绑定代码，但是整个底层数据库查询实际还是要自己写的，工作量也比较大，而且不太容易适应快速数据库修改</p></li><li><p>二级缓存机制不佳</p></li></ol><h2 id="二、简单实例"><a href="#二、简单实例" class="headerlink" title="二、简单实例"></a>二、简单实例</h2><h3 id="1、导入依赖"><a href="#1、导入依赖" class="headerlink" title="1、导入依赖"></a>1、导入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        </span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- junit --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2、简单的增删改查案例"><a href="#2、简单的增删改查案例" class="headerlink" title="2、简单的增删改查案例"></a>2、简单的增删改查案例</h3><h4 id="2-0、-数据库及项目框架图"><a href="#2-0、-数据库及项目框架图" class="headerlink" title="2.0、 数据库及项目框架图"></a>2.0、 数据库及项目框架图</h4><p><a href="https://imgchr.com/i/yRj6SA" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://s3.ax1x.com/2021/02/18/yRj6SA.png" alt="yRj6SA.png"></a><br><a href="https://imgchr.com/i/yRjcQI" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://s3.ax1x.com/2021/02/18/yRjcQI.png" alt="yRjcQI.png"></a></p><h4 id="2-1、需求、准备工作"><a href="#2-1、需求、准备工作" class="headerlink" title="2.1、需求、准备工作"></a>2.1、需求、准备工作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 需求：满足mybits的增删改查案例</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h4 id="2-2、编写数据库文件"><a href="#2-2、编写数据库文件" class="headerlink" title="2.2、编写数据库文件"></a>2.2、编写数据库文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SET NAMES utf8mb4;</span><br><span class="line">SET FOREIGN_KEY_CHECKS &#x3D; 0;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure for user</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS &#96;user&#96;;</span><br><span class="line">CREATE TABLE &#96;user&#96;  (</span><br><span class="line">  &#96;id&#96; int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  &#96;userName&#96; varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,</span><br><span class="line">  &#96;passWord&#96; varchar(200) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,</span><br><span class="line">  &#96;enabled&#96; varchar(10) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,</span><br><span class="line">  &#96;registerTime&#96; varchar(25) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;id&#96;) USING BTREE</span><br><span class="line">) ENGINE &#x3D; InnoDB AUTO_INCREMENT &#x3D; 43 CHARACTER SET &#x3D; utf8 COLLATE &#x3D; utf8_general_ci ROW_FORMAT &#x3D; Dynamic;</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS &#x3D; 1;</span><br></pre></td></tr></table></figure><h4 id="2-3、编写实体类"><a href="#2-3、编写实体类" class="headerlink" title="2.3、编写实体类"></a>2.3、编写实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Integer id;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//"enabled": "用户是否挂起",</span></span><br><span class="line">    String enabled;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//"password": "授权码（口令）",</span></span><br><span class="line">    String passWord;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//"registerTime": "注册时间",</span></span><br><span class="line">    String registerTime;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//登录名</span></span><br><span class="line">    String userName;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getEnabled</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> enabled;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEnabled</span><span class="params">(String enabled)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.enabled = enabled;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPassWord</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> passWord;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassWord</span><span class="params">(String passWord)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.passWord = passWord;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getRegisterTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> registerTime;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRegisterTime</span><span class="params">(String registerTime)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.registerTime = registerTime;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getUserName</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> userName;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserName</span><span class="params">(String userName)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.userName = userName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"Users [id="</span> + id + <span class="string">",enabled="</span> + enabled + <span class="string">", passWord="</span> + passWord</span><br><span class="line">+ <span class="string">", registerTime="</span> + registerTime + <span class="string">", userName="</span> + userName ]<span class="string">";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="2-4-mapper-xml文件"><a href="#2-4-mapper-xml文件" class="headerlink" title="2.4 mapper.xml文件"></a>2.4 mapper.xml文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> &gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--namespace:命名空间,指定为接口的全类名--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- parameterType为输入参数类型 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- resultType为返回参数类型 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.web.zswl.sjpd.dao.UsersMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 根据username查询信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsersByUserName"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span> <span class="attr">resultType</span>=<span class="string">"com.web.zswl.sjpd.bean.Users"</span>&gt;</span></span><br><span class="line">        SELECT * FROM user</span><br><span class="line">        where username = #&#123;username&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 模糊查询问题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsersByLikeUserName"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span> <span class="attr">resultType</span>=<span class="string">"java.util.List"</span>&gt;</span></span><br><span class="line">        SELECT * FROM user</span><br><span class="line">       WHERE username LIKE concat('%',#&#123;userName&#125;,'%')</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 插入一条信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.web.zswl.sjpd.bean.Users"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">        INSERT INTO user(username,password,enabled,registertime) VALUES (#&#123;userName&#125;,#&#123;passWord&#125;,#&#123;enabled&#125;,#&#123;registerTime&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 更新一条信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.web.zswl.sjpd.bean.Users"</span>&gt;</span></span><br><span class="line">        UPDATE user SET username=#&#123;userName&#125;,password=#&#123;passWord&#125;,enabled=#&#123;enabled&#125;,registertime=#&#123;registerTime&#125; where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 删除一条信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUserById"</span>&gt;</span></span><br><span class="line">        DELETE from user where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-5-编写mapper接口"><a href="#2-5-编写mapper接口" class="headerlink" title="2.5 编写mapper接口"></a>2.5 编写mapper接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/**根据用户名称获取用户信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> username  用户名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>  用户实体类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Users <span class="title">getUsersByUserName</span><span class="params">(String username)</span> </span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模糊查询</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">getUsersByLikeUserName</span><span class="params">(String userName)</span></span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询所有</span></span><br><span class="line"><span class="comment">     * 这种写法可以用于简单的sql操作，复杂的请写在sql的xml映射文件中</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user"</span>)</span><br><span class="line">    <span class="function">List&lt;Users&gt; <span class="title">getAllUser</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加一条信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(Users user)</span></span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 更新一条信息</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(Users user)</span></span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 删除一条信息</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">deleteUserById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-6-编写service接口"><a href="#2-6-编写service接口" class="headerlink" title="2.6 编写service接口"></a>2.6 编写service接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取所有users表中的信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">getAllUsers</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/**获取用户信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Users <span class="title">getUsers</span><span class="params">(String username)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模糊查询</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">getLikeUserName</span><span class="params">(String userName)</span></span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加一条信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(Users user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新一条信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(Users user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除一条信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUserById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-7-编写service接口的实现类"><a href="#2-7-编写service接口的实现类" class="headerlink" title="2.7 编写service接口的实现类"></a>2.7 编写service接口的实现类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersServiceImp</span> <span class="keyword">implements</span> <span class="title">UsersService</span> </span>&#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">UsersMapper usersDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询所有</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">getAllUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">List&lt;Users&gt; users = usersDao.getAllUser();</span><br><span class="line"><span class="keyword">return</span> users;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据username查询信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Users <span class="title">getUsers</span><span class="params">(String usename)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Users usr = usersDao.getUsersByUserName(usename);</span><br><span class="line"><span class="keyword">return</span> usr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模糊查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">getLikeUserName</span><span class="params">(String userName)</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">List&lt;Users&gt; users = usersDao.getUsersByLikeUserName(userName);</span><br><span class="line"><span class="keyword">return</span> users;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(Users user)</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">usersDao.insertUser(user);</span><br><span class="line">System.out.println(<span class="string">"insert success"</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">System.out.println(e.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(Users user)</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">usersDao.updateUser(user);</span><br><span class="line">System.out.println(<span class="string">"update success"</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">System.out.println(e.toString());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUserById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">usersDao.deleteUserById(id);</span><br><span class="line">System.out.println(<span class="string">"delete success"</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">System.out.println(e.toString());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-7-编写测试类"><a href="#2-7-编写测试类" class="headerlink" title="2.7 编写测试类"></a>2.7 编写测试类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">AppTest</span> </span>&#123;</span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line">UsersService user;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试查询user表中所有信息实例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getAllUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">List&lt;Users&gt; users=user.getAllUsers();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; users.size(); i++) &#123;</span><br><span class="line">System.out.println(users.get(i).toString());</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试查询user表中username为admin的信息实例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.err.println(user.getUsers(<span class="string">"admin"</span>));</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试模糊查询</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getLikeName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Users&gt; users=user.getLikeUserName(<span class="string">"user"</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; users.size(); i++) &#123;</span><br><span class="line">System.out.println(users.get(i).toString());</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试添加信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Users User = <span class="keyword">new</span> Users();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>) &#123;</span><br><span class="line">    User.setEnabled(<span class="string">"1"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    User.setEnabled(<span class="string">"0"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    SimpleDateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);<span class="comment">//设置日期格式</span></span><br><span class="line">    String nowdate=df.format(<span class="keyword">new</span> Date());</span><br><span class="line">    User.setRegisterTime(nowdate);</span><br><span class="line">    User.setPassWord(<span class="string">"123456"</span>);</span><br><span class="line">    User.setUserName(<span class="string">"user"</span>+i);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//执行添加操作</span></span><br><span class="line">    user.insertUser(User);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试更新信息,根据id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Users User = <span class="keyword">new</span> Users();</span><br><span class="line">    User.setId(<span class="number">22</span>);</span><br><span class="line">    User.setEnabled(<span class="string">"null"</span>);</span><br><span class="line">SimpleDateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);<span class="comment">//设置日期格式</span></span><br><span class="line">String nowdate=df.format(<span class="keyword">new</span> Date());</span><br><span class="line">User.setRegisterTime(nowdate);</span><br><span class="line">User.setPassWord(<span class="string">"123456"</span>);</span><br><span class="line">User.setUserName(<span class="string">"牛啊牛啊"</span>);</span><br><span class="line">user.updateUser(User);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试删除信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    user.deleteUserById(<span class="number">22</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="三、分页查询（补充材料）"><a href="#三、分页查询（补充材料）" class="headerlink" title="三、分页查询（补充材料）"></a>三、分页查询（补充材料）</h2><p><a href="https://www.w3cschool.cn/mybatis/mybatis-ypsj3bpi.html" target="_blank" rel="noopener">https://www.w3cschool.cn/mybatis/mybatis-ypsj3bpi.html</a></p>]]></content>
      
      
      <categories>
          
          <category> mybits SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EasyExcel的基本操作</title>
      <link href="/2021/02/02/210202_EasyExcel/"/>
      <url>/2021/02/02/210202_EasyExcel/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><h1 id="EasyExcel"><a href="#EasyExcel" class="headerlink" title="EasyExcel"></a><code>EasyExcel</code></h1><h2 id="一、初识EasyExcel"><a href="#一、初识EasyExcel" class="headerlink" title="一、初识EasyExcel"></a>一、初识<code>EasyExcel</code></h2><h3 id="1-Apache-POI"><a href="#1-Apache-POI" class="headerlink" title="1. Apache POI"></a>1. Apache POI</h3><p>先说<code>POI</code>，有过报表导入导出经验的同学，应该听过或者使用。</p><p><code>Apache POI</code>是Apache软件基金会的开源函式库，提供跨平台的<code>Java API</code>实现<code>Microsoft Office</code>格式档案读写。但是存在如下一些问题：</p><h4 id="1-1-学习使用成本较高"><a href="#1-1-学习使用成本较高" class="headerlink" title="1.1 学习使用成本较高"></a>1.1 学习使用成本较高</h4><p>对POI有过深入了解的才知道原来POI还有SAX模式（Dom解析模式）。但SAX模式相对比较复杂，excel有03和07两种版本，两个版本数据存储方式截然不同，sax解析方式也各不一样。</p><p>想要了解清楚这两种解析方式，才去写代码测试，估计两天时间是需要的。再加上即使解析完，要转换到自己业务模型还要很多繁琐的代码。总体下来感觉至少需要三天，由于代码复杂，后续维护成本巨大。</p><p>POI的SAX模式的API可以一定程度的解决一些内存溢出的问题，但是POI还是有一些缺陷，比如07版Excel解压缩以及解压后存储都是在内存中完成的，内存消耗依然很大，一个3M的Excel用POI的SAX解析，依然需要100M左右内存。</p><h4 id="1-2-POI的内存消耗较大"><a href="#1-2-POI的内存消耗较大" class="headerlink" title="1.2 POI的内存消耗较大"></a>1.2 POI的内存消耗较大</h4><p>大部分使用POI都是使用他的userModel模式。userModel的好处是上手容易使用简单，随便拷贝个代码跑一下，剩下就是写业务转换了，虽然转换也要写上百行代码，相对比较好理解。然而userModel模式最大的问题是在于非常大的内存消耗，一个几兆的文件解析要用掉上百兆的内存。现在很多应用采用这种模式，之所以还正常在跑一定是并发不大，并发上来后一定会OOM或者频繁的full gc。</p><p>总体上来说，简单写法重度依赖内存，复杂写法学习成本高。</p><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ol><li><p>功能强大</p></li><li><p>代码书写冗余繁杂</p></li><li><p>读写大文件耗费内存较大，容易OOM</p></li></ol><h3 id="2-EasyExcel"><a href="#2-EasyExcel" class="headerlink" title="2. EasyExcel"></a>2. <code>EasyExcel</code></h3><h4 id="2-1-重写了POI对07版Excel的解析"><a href="#2-1-重写了POI对07版Excel的解析" class="headerlink" title="2.1 重写了POI对07版Excel的解析"></a>2.1 重写了POI对07版Excel的解析</h4><ul><li><p>EasyExcel重写了POI对07版Excel的解析，可以把内存消耗从100M左右降低到10M以内，并且再大的Excel不会出现内存溢出，03版仍依赖POI的SAX模式。</p></li><li><p>下图为64M内存1分钟内读取75M(46W行25列)的Excel（当然还有急速模式能更快，但是内存占用会在100M多一点）</p></li></ul><p><img src= "/img/loading.gif" data-src="imgs/large.png" alt="img"></p><ul><li>在上层做了模型转换的封装，让使用者更加简单方便</li></ul><h4 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h4><ol><li>在数据模型层面进行了封装，<strong>使用简单</strong></li><li>重写了07版本的Excel的解析代码，降低内存消耗，能有效避免OOM</li><li>只能操作Excel</li><li>不能读取图片</li></ol><ol start="0"><li>使用程序读写excel，数据在excel文件、程序&lt;实体类、Map&gt;这两个载体中间相互流转。</li></ol><p>优雅编程    lombok</p><h2 id="二、快速入门–QuickStart"><a href="#二、快速入门–QuickStart" class="headerlink" title="二、快速入门–QuickStart"></a>二、快速入门–QuickStart</h2><h3 id="0、导入依赖坐标"><a href="#0、导入依赖坐标" class="headerlink" title="0、导入依赖坐标"></a>0、导入依赖坐标</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- EasyExcel --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- lombok 优雅编程 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- junit --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>导入<code>easyexcel-2.1.6</code>坐标的时候，以依赖传递导入<code>poi-3.17</code>的POI。如果    ·</p></blockquote><h3 id="1、最简单的读"><a href="#1、最简单的读" class="headerlink" title="1、最简单的读"></a>1、最简单的读</h3><h4 id="1-1、需求、准备工作"><a href="#1-1、需求、准备工作" class="headerlink" title="1.1、需求、准备工作"></a>1.1、需求、准备工作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 需求：单实体导入</span></span><br><span class="line"><span class="comment"> * 导入Excel学员信息到系统。</span></span><br><span class="line"><span class="comment"> * 包含如下列：姓名、性别、出生日期</span></span><br><span class="line"><span class="comment"> * 模板详见：杭州黑马在线202003班学员信息.xls</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 杭州黑马在线202003班学员信息.xls文件</span></span><br></pre></td></tr></table></figure><h4 id="1-2、编写导出数据的实体"><a href="#1-2、编写导出数据的实体" class="headerlink" title="1.2、编写导出数据的实体"></a>1.2、编写导出数据的实体</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基于lombok</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生姓名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生性别</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生出生日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-3、-读取Excel文件"><a href="#1-3、-读取Excel文件" class="headerlink" title="1.3、 读取Excel文件"></a>1.3、 读取<code>Excel</code>文件</h4><p>调用<code>EasyExcel</code>的<code>API</code>读取的<code>Excel</code>文件的测试类<code>StudentReadDemo</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.read.builder.ExcelReaderSheetBuilder;</span><br><span class="line"><span class="keyword">import</span> com.itheima.domain.Student;</span><br><span class="line"><span class="keyword">import</span> com.itheima.listener.StudentReadListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> Vsunks.v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/3/11 23:28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentReadDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">        <span class="comment">// 读取文件，读取完之后会自动关闭</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        pathName  文件路径；"d:\\杭州黑马在线202003班学员信息.xls"</span></span><br><span class="line"><span class="comment">        head每行数据对应的实体；Student.class</span></span><br><span class="line"><span class="comment">        readListener读监听器，每读一样就会调用一次该监听器的invoke方法</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        sheet方法参数： 工作表的顺序号（从0开始）或者工作表的名字，不传默认为0</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">// 封装工作簿对象</span></span><br><span class="line">        ExcelReaderBuilder workBook = EasyExcel.read</span><br><span class="line">                (<span class="string">"d:\\杭州黑马在线202003班学员信息.xls"</span>, Student<span class="class">.<span class="keyword">class</span>, <span class="title">new</span> <span class="title">StudentReadListener</span>())</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 封装工作表</span></span><br><span class="line">        ExcelReaderSheetBuilder sheet1 = workBook.sheet();</span><br><span class="line">        <span class="comment">// 读取</span></span><br><span class="line">        sheet1.doRead();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>读取Excel的监听器，用于处理读取产生的数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.context.AnalysisContext;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.event.AnalysisEventListener;</span><br><span class="line"><span class="keyword">import</span> com.itheima.domain.Student;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> Vsunks.v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/3/11 23:12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentReadListener</span> <span class="keyword">extends</span> <span class="title">AnalysisEventListener</span>&lt;<span class="title">Student</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// 每读一样，会调用该invoke方法一次</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Student data, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"data = "</span> + data);</span><br><span class="line">        log.info(data + <span class="string">"保存成功"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 全部读完之后，会调用该方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO......</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2、最简单的写"><a href="#2、最简单的写" class="headerlink" title="2、最简单的写"></a>2、最简单的写</h3><h4 id="2-1-需求、准备工作"><a href="#2-1-需求、准备工作" class="headerlink" title="2.1 需求、准备工作"></a>2.1 需求、准备工作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 需求：单实体导出</span></span><br><span class="line"><span class="comment"> * 导出多个学生对象到Excel表格</span></span><br><span class="line"><span class="comment"> * 包含如下列：姓名、性别、出生日期</span></span><br><span class="line"><span class="comment"> * 模板详见：杭州黑马在线202003班学员信息.xlsx</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h4 id="2-2、编写导出数据的实体"><a href="#2-2、编写导出数据的实体" class="headerlink" title="2.2、编写导出数据的实体"></a>2.2、编写导出数据的实体</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用lombok</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.domain;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@ColumnWidth</span>(<span class="number">20</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//@ExcelProperty(value = "编号",index = 3)</span></span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生姓名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"学生姓名"</span>, index = <span class="number">0</span>)</span><br><span class="line">    <span class="comment">//@ColumnWidth(30)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生性别</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"学生性别"</span>, index = <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生出生日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"学生出生日期"</span>, index = <span class="number">1</span>)</span><br><span class="line">    <span class="comment">//@ColumnWidth(20)</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-3、-准备数据并写入到文件"><a href="#2-3、-准备数据并写入到文件" class="headerlink" title="2.3、 准备数据并写入到文件"></a>2.3、 准备数据并写入到文件</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.builder.ExcelWriterBuilder;</span><br><span class="line"><span class="keyword">import</span> com.itheima.domain.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> Vsunks.v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2020/3/11 23:27</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentWriteDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Student&gt; students = initData();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            String pathName 写入文件的路径</span></span><br><span class="line"><span class="comment">            Class head      写入文件的对象类型</span></span><br><span class="line"><span class="comment">            默认写入到07的xlsx中，如果想要写入xls，可以指定类型（待验证）</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        ExcelWriterBuilder workBook = EasyExcel.write(<span class="string">"d:\\杭州黑马学员表.xlsx"</span>, Student<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// sheet方法参数： 工作表的顺序号（从0开始）或者工作表的名字</span></span><br><span class="line">        workBook.sheet().doWrite(students);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Student&gt; <span class="title">initData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Student&gt; students = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span><br><span class="line">        Student data = <span class="keyword">new</span> Student();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            data.setName(<span class="string">"杭州黑马学号0"</span> + i);</span><br><span class="line">            data.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">            data.setGender(<span class="string">"男"</span>);</span><br><span class="line">            students.add(data);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> students;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3、文件上传和下载"><a href="#3、文件上传和下载" class="headerlink" title="3、文件上传和下载"></a>3、文件上传和下载</h3><p>基于SpringMVC的文件上传和下载</p><p><strong>0. 导入依赖</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- EasyExcel --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- lombok --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- junit --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-nop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SpringMVC（Spring） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Servlet --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 文件上传 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-1-文件上传"><a href="#3-1-文件上传" class="headerlink" title="3.1 文件上传"></a>3.1 文件上传</h4><p>编写excel中每一行对应的实体类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生姓名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生性别</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生出生日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编写回调监听器StudentReadListener</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope</span>(<span class="string">"prototype"</span>)<span class="comment">// 作者要求每次读取都要使用新的Listener</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentReadListener</span> <span class="keyword">extends</span> <span class="title">AnalysisEventListener</span>&lt;<span class="title">Student</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StudentService studentService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> BATCH_SAVE_NUM = <span class="number">5</span>;</span><br><span class="line">    ArrayList&lt;Student&gt; students = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 每读一样，会调用该invoke方法一次</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Student data, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        students.add(data);</span><br><span class="line">        <span class="keyword">if</span> (++count % BATCH_SAVE_NUM == <span class="number">0</span>) &#123;</span><br><span class="line">            studentService.save(students);</span><br><span class="line">            students.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 全部读完之后，会调用该方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO......</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>业务代码接口StudentService和实现类StudentServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(ArrayList&lt;Student&gt; students)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(ArrayList&lt;Student&gt; students)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"students in service = "</span> + students);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Spring配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 组件扫描--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.itheima"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>SpringMVC配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 组件扫描--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.itheima.demo"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- MVC文件上传多部件解析器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">"multipartResolver"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>编码读取上传的Excel文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebUploadAndDownload</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件上传</span></span><br><span class="line"><span class="comment">     * 1. 编写excel中每一行对应的实体类</span></span><br><span class="line"><span class="comment">     * 2. 由于默认异步读取excel，所以需要逐行读取的回调监听器</span></span><br><span class="line"><span class="comment">     * 3. 开始读取Excel</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"upload"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ExcelReaderBuilder workBook = EasyExcel.read(file.getInputStream(), Student<span class="class">.<span class="keyword">class</span>, <span class="title">studentReadListener</span>)</span>;</span><br><span class="line">        workBook.sheet().doRead();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-文件下载"><a href="#3-2-文件下载" class="headerlink" title="3.2 文件下载"></a>3.2 文件下载</h4><p>编写实体类并创建对象以便写入表格</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生姓名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//@ExcelProperty(&#123;"学员信息表", "学生姓名"&#125;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"学生姓名"</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生性别</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//@ExcelProperty(&#123;"学员信息表", "学生性别"&#125;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"学生性别"</span>)</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生出生日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//@ExcelProperty(&#123;"学员信息表", "学生出生日期"&#125;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"学生出生日期"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 循环生成10个学生对象</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Student&gt; <span class="title">initData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;Student&gt; students = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        Student data = <span class="keyword">new</span> Student();</span><br><span class="line">        data.setName(<span class="string">"杭州黑马学号0"</span> + i);</span><br><span class="line">        data.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">        data.setGender(<span class="string">"男"</span>);</span><br><span class="line">        students.add(data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编码将数据写入到响应体实现下载</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebUploadAndDownload</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件下载</span></span><br><span class="line"><span class="comment">     * 1. 编写实体类并创建对象以便写入表格</span></span><br><span class="line"><span class="comment">     * 2. 设置响应参数：文件的ContentType和文件名，同时设置编码避免乱码</span></span><br><span class="line"><span class="comment">     * 3. 直接写，内部会调用finish方法自动关闭OutputStream</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"download"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">download</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"application/vnd.ms-excel"</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="comment">// 防止中文乱码 </span></span><br><span class="line">        String fileName = URLEncoder.encode(<span class="string">"测试"</span>, <span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Content-Disposition"</span>, <span class="string">"attachment; filename*=UTF-8''"</span> + fileName + <span class="string">".xlsx"</span>);</span><br><span class="line">        ExcelWriterBuilder workBook = EasyExcel.write(response.getOutputStream(), Student<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        ExcelWriterSheetBuilder sheet = workBook.sheet(<span class="string">"模板"</span>);</span><br><span class="line">        </span><br><span class="line">        sheet.doWrite(initData());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4、自定义单元格样式"><a href="#4、自定义单元格样式" class="headerlink" title="4、自定义单元格样式"></a>4、自定义单元格样式</h3><p>EasyExcel支持调整行高、列宽、背景色、字体大小等内容，但是控制方式与使用原生POI无异，比较繁琐，不建议使用。</p><p>但是可以使用模板填充的方式，向预设样式的表格中直接写入数据，写入数据的时候会保持原有样式。</p><h2 id="三、填充"><a href="#三、填充" class="headerlink" title="三、填充"></a>三、填充</h2><h3 id="1、填充一组数据"><a href="#1、填充一组数据" class="headerlink" title="1、填充一组数据"></a>1、填充一组数据</h3><h4 id="1-1-准备模板"><a href="#1-1-准备模板" class="headerlink" title="1.1 准备模板"></a>1.1 准备模板</h4><p>​    Excel表格中用{} 来表示包裹要填充的变量，如果单元格文本中本来就有<code>{</code>、<code>}</code>左右大括号，需要在括号前面使用斜杠转义<code>\{</code>、<code>\}</code>。</p><p>​    代码中被填充数据的实体对象的成员变量名或被填充map集合的key需要和Excel中被{}包裹的变量名称一致。</p><p><img src= "/img/loading.gif" data-src="imgs/simpleFillTemplate.png" alt=""></p><h4 id="1-2-封装数据"><a href="#1-2-封装数据" class="headerlink" title="1.2 封装数据"></a>1.2 封装数据</h4><p>编写封装填充数据的类或选用Map</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用实体类封装填充数据</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  实体中成员变量名称需要和Excel表各种&#123;&#125;包裹的变量名匹配</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FillData</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成多组数据代码</span></span><br><span class="line"><span class="comment"> * / </span></span><br><span class="line"><span class="comment">    private static List&lt;FillData&gt; initFillData() &#123;</span></span><br><span class="line"><span class="comment">        ArrayList&lt;FillData&gt; fillDatas = new ArrayList&lt;FillData&gt;();</span></span><br><span class="line"><span class="comment">        for (int i = 0; i &lt; 10; i++) &#123;</span></span><br><span class="line"><span class="comment">            FillData fillData = new FillData();</span></span><br><span class="line"><span class="comment">            fillData.setName("杭州黑马0" + i);</span></span><br><span class="line"><span class="comment">            fillData.setAge(10 + i);</span></span><br><span class="line"><span class="comment">            fillDatas.add(fillData);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        return fillDatas;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br></pre></td></tr></table></figure><h4 id="1-3-填充"><a href="#1-3-填充" class="headerlink" title="1.3 填充"></a>1.3 填充</h4><p>准备数据并填充到文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 加载模板</span></span><br><span class="line">    InputStream templateFile = FillData<span class="class">.<span class="keyword">class</span>.<span class="title">getClassLoader</span>().<span class="title">getResourceAsStream</span>(</span></span><br><span class="line">            "fill_data_template1" +</span><br><span class="line">            <span class="string">".xlsx"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入文件</span></span><br><span class="line">    String targetFileName = <span class="string">"单组数据填充.xlsx"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 准备对象数据填充</span></span><br><span class="line">    FillData fillData = <span class="keyword">new</span> FillData();</span><br><span class="line">    fillData.setName(<span class="string">"杭州黑马"</span>);</span><br><span class="line">    fillData.setAge(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成工作簿对象</span></span><br><span class="line">    ExcelWriterBuilder workBookWriter = EasyExcel.write(targetFileName).withTemplate(templateFile);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取工作表并填充</span></span><br><span class="line">    <span class="comment">//workBookWriter.sheet().doFill(fillData);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用Map数据填充</span></span><br><span class="line">    HashMap&lt;String, String&gt; mapFillData = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    mapFillData.put(<span class="string">"name"</span>, <span class="string">"杭州黑马Map"</span>);</span><br><span class="line">    mapFillData.put(<span class="string">"age"</span>, <span class="string">"11"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取第一个工作表填充并自动关闭流</span></span><br><span class="line">    workBookWriter.sheet().doFill(mapFillData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>1.4 效果</strong></p><h3 id="2、填充多组数据"><a href="#2、填充多组数据" class="headerlink" title="2、填充多组数据"></a>2、填充多组数据</h3><h4 id="2-1-准备模板"><a href="#2-1-准备模板" class="headerlink" title="2.1 准备模板"></a>2.1 准备模板</h4><p>​    Excel表格中用<code>{.}</code>来表示包裹要填充的变量，如果单元格文本中本来就有<code>{</code>、<code>}</code>左右大括号，需要在括号前面使用斜杠转义<code>\{</code>  、<code>\}</code>。</p><p>​    代码中被填充数据的实体对象的成员变量名或被填充map集合的key需要和Excel中被{}包裹的变量名称一致。</p><p><img src= "/img/loading.gif" data-src="imgs/complexFillTempl.png" alt=""></p><h4 id="2-2-封装数据"><a href="#2-2-封装数据" class="headerlink" title="2.2 封装数据"></a>2.2 封装数据</h4><p>编写封装填充数据的类或选用Map</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同上</span></span><br></pre></td></tr></table></figure><h4 id="2-3-填充"><a href="#2-3-填充" class="headerlink" title="2.3 填充"></a>2.3 填充</h4><p>准备数据并填充到文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 加载模板</span></span><br><span class="line">    InputStream templateFile = FillData<span class="class">.<span class="keyword">class</span>.<span class="title">getClassLoader</span>().<span class="title">getResourceAsStream</span>(</span></span><br><span class="line">            "fill_data_template2.xlsx");</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入文件</span></span><br><span class="line">    String targetFileName = <span class="string">"多组数据填充.xlsx"</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;FillData&gt; fillDatas = initData();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成工作簿对象</span></span><br><span class="line">    ExcelWriterBuilder workBookWriter =</span><br><span class="line">            EasyExcel.write(targetFileName).withTemplate(templateFile);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取第一个工作表填充并自动关闭流</span></span><br><span class="line">    workBookWriter.sheet().doFill(fillDatas);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3、组合填充"><a href="#3、组合填充" class="headerlink" title="3、组合填充"></a>3、组合填充</h3><h4 id="3-1-准备模板"><a href="#3-1-准备模板" class="headerlink" title="3.1 准备模板"></a>3.1 准备模板</h4><p>即有多组数据填充，又有单一数据填充，为了避免两者数据出现冲突覆盖的情况，在多组填充时需要通过<code>FillConfig</code>对象设置换行。</p><p><img src= "/img/loading.gif" data-src="imgs/mixFillTemplate.png" alt="1584207785924"></p><h4 id="3-2-封装数据"><a href="#3-2-封装数据" class="headerlink" title="3.2 封装数据"></a>3.2 封装数据</h4><p>编写封装填充数据的类或选用Map</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同上</span></span><br></pre></td></tr></table></figure><h4 id="3-3-填充"><a href="#3-3-填充" class="headerlink" title="3.3 填充"></a>3.3 填充</h4><p>准备数据并填充到文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载模板</span></span><br><span class="line">    InputStream templateFile = FillData<span class="class">.<span class="keyword">class</span>.<span class="title">getClassLoader</span>().<span class="title">getResourceAsStream</span>(</span></span><br><span class="line">            "fill_data_template3.xlsx");</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 目标文件</span></span><br><span class="line">    String targetFileName = <span class="string">"组合数据填充.xlsx"</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;FillData&gt; fillDatas = initData();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成工作簿对象</span></span><br><span class="line">    ExcelWriter excelWriter = EasyExcel.write(targetFileName).withTemplate(templateFile).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成工作表对象</span></span><br><span class="line">    WriteSheet writeSheet = EasyExcel.writerSheet().build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 组合填充时，因为多组填充的数据量不确定，需要在多组填充完之后另起一行</span></span><br><span class="line">    FillConfig fillConfig = FillConfig.builder().forceNewRow(<span class="keyword">true</span>).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 填充并换行</span></span><br><span class="line">    excelWriter.fill(fillDatas, fillConfig, writeSheet);</span><br><span class="line"></span><br><span class="line">    HashMap&lt;String, String&gt; otherData = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    otherData.put(<span class="string">"date"</span>, <span class="string">"2020-03-14"</span>);</span><br><span class="line">    otherData.put(<span class="string">"total"</span>, <span class="string">"100"</span>);</span><br><span class="line">    excelWriter.fill(otherData, writeSheet);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭</span></span><br><span class="line">    excelWriter.finish();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4、水平填充"><a href="#4、水平填充" class="headerlink" title="4、水平填充"></a>4、水平填充</h3><h4 id="4-1-准备模板"><a href="#4-1-准备模板" class="headerlink" title="4.1 准备模板"></a>4.1 准备模板</h4><p>水平填充和多组填充模板一样，不一样的地方在于，填充时需要通过<code>FillConfig</code>对象设置水平填充。</p><p><img src= "/img/loading.gif" data-src="imgs/HORIZONTALFillTemplate.png" alt=""></p><h4 id="4-2-封装数据"><a href="#4-2-封装数据" class="headerlink" title="4.2 封装数据"></a>4.2 封装数据</h4><p>编写封装填充数据的类或选用Map</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同上</span></span><br></pre></td></tr></table></figure><h4 id="4-3-填充"><a href="#4-3-填充" class="headerlink" title="4.3 填充"></a>4.3 填充</h4><p>准备数据并填充到文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载模板</span></span><br><span class="line">    InputStream templateFile = FillData<span class="class">.<span class="keyword">class</span>.<span class="title">getClassLoader</span>().<span class="title">getResourceAsStream</span>(</span></span><br><span class="line">            "fill_data_template4.xlsx");</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入文件</span></span><br><span class="line">    String targetFileName = <span class="string">"easyExcelDemo\\水平数据填充.xlsx"</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;FillData&gt; fillDatas = initData();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成工作簿对象</span></span><br><span class="line">    ExcelWriter excelWriter = EasyExcel.write(targetFileName).withTemplate(templateFile).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成工作表对象</span></span><br><span class="line">    WriteSheet writeSheet = EasyExcel.writerSheet().build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 组合填充时，因为多组填充的数据量不确定，需要在多组填充完之后另起一行</span></span><br><span class="line">    FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 填充</span></span><br><span class="line">    excelWriter.fill(fillDatas, fillConfig, writeSheet);</span><br><span class="line"></span><br><span class="line">    HashMap&lt;String, String&gt; otherData = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    otherData.put(<span class="string">"date"</span>, <span class="string">"2020-03-14"</span>);</span><br><span class="line">    otherData.put(<span class="string">"total"</span>, <span class="string">"100"</span>);</span><br><span class="line">    excelWriter.fill(otherData, writeSheet);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭</span></span><br><span class="line">    excelWriter.finish();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5、-注意事项"><a href="#5、-注意事项" class="headerlink" title="5、 注意事项"></a>5、 注意事项</h3><p>​    为了节省内存，所以没有采用把整个文档在内存中组织好之后再整体写入到文件的做法，而是采用的是一行一行写入的方式，不能实现删除和移动行，也不支持备注写入。多组数据写入的时候，如果需要新增行，只能在最后一行增加，不能在中间位置添加。</p><h3 id="6、填充综合练习"><a href="#6、填充综合练习" class="headerlink" title="6、填充综合练习"></a>6、填充综合练习</h3><p>见<code>report_template.xlsx</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * reprot综合练习</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test06</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    InputStream templateInputStream = <span class="keyword">this</span>.getClass().getClassLoader().getResourceAsStream(</span><br><span class="line">            <span class="string">"report_template.xlsx"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 目标文件</span></span><br><span class="line">    String targetFile = <span class="string">"模板写入6-report.xlsx"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入workbook对象</span></span><br><span class="line"></span><br><span class="line">    ExcelWriter workBook =</span><br><span class="line">            EasyExcel.write(targetFile, FillData<span class="class">.<span class="keyword">class</span>).<span class="title">withTemplate</span>(<span class="title">templateInputStream</span>).<span class="title">build</span>()</span>;</span><br><span class="line"></span><br><span class="line">    WriteSheet sheet = EasyExcel.writerSheet().build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 填充配置，开启组合填充换行</span></span><br><span class="line">    <span class="comment">//FillConfig fillConfig = FillConfig.builder().forceNewRow(true).build();</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ****** 准备数据 *******</span></span><br><span class="line">    <span class="comment">// 日期</span></span><br><span class="line">    HashMap&lt;String, String&gt; dateMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    dateMap.put(<span class="string">"date"</span>, <span class="string">"2020-03-16"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 总会员数</span></span><br><span class="line">    HashMap&lt;String, String&gt; totalCountMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    dateMap.put(<span class="string">"totalCount"</span>, <span class="string">"1000"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 新增员数</span></span><br><span class="line">    HashMap&lt;String, String&gt; increaseCountMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    dateMap.put(<span class="string">"increaseCount"</span>, <span class="string">"100"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 本周新增会员数</span></span><br><span class="line">    HashMap&lt;String, String&gt; increaseCountWeekMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    dateMap.put(<span class="string">"increaseCountWeek"</span>, <span class="string">"50"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 本月新增会员数</span></span><br><span class="line">    HashMap&lt;String, String&gt; increaseCountMonthMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    dateMap.put(<span class="string">"increaseCountMonth"</span>, <span class="string">"100"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 新增会员数据</span></span><br><span class="line">    List&lt;Student&gt; students = initData();</span><br><span class="line">    <span class="comment">// **** 准备数据结束****</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入统计数据</span></span><br><span class="line">    workBook.fill(dateMap, sheet);</span><br><span class="line">    workBook.fill(totalCountMap, sheet);</span><br><span class="line">    workBook.fill(increaseCountMap, sheet);</span><br><span class="line">    workBook.fill(increaseCountWeekMap, sheet);</span><br><span class="line">    workBook.fill(increaseCountMonthMap, sheet);</span><br><span class="line">    <span class="comment">// 写入新增会员</span></span><br><span class="line">    workBook.fill(students, sheet);</span><br><span class="line">    workBook.finish();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="四、常用API及注解"><a href="#四、常用API及注解" class="headerlink" title="四、常用API及注解"></a>四、常用API及注解</h2><h3 id="1、常用类"><a href="#1、常用类" class="headerlink" title="1、常用类"></a>1、常用类</h3><ul><li><strong>EasyExcel</strong> 入口类，用于构建各种对象、开始各种操作；</li><li><strong>ExcelReaderBuilder</strong> 构建出一个ReadWorkbook对象，即一个工作簿对象，对应的是一个Excel文件；</li><li><strong>ExcelWriterBuilder</strong> 构建出一个WriteWorkbook对象，即一个工作簿对象，对应的是一个Excel文件；</li><li><strong>ExcelReaderSheetBuilder</strong> 构建出一个ReadSheet对象，即一个工作表的对象，对应的Excel中的每个sheet，一个工作簿可以有多个工作表；</li><li><strong>ExcelWriterSheetBuilder</strong> 构建出一WriteSheet对象，即一个工作表的对象，对应的Excel中的每个sheet，一个工作簿可以有多个工作表；</li><li><strong>ReadListener</strong> 在每一行读取完毕后都会调用ReadListener来处理数据，我们可以把调用service的代码可以写在其<strong>invoke</strong>方法内部；</li><li><strong>WriteHandler</strong> 在每一个操作包括创建单元格、创建表格等都会调用WriteHandler来处理数据，对使用者透明不可见；</li><li><strong>所有配置都是继承的</strong> Workbook的配置会被Sheet继承。所以在用EasyExcel设置参数的时候，在EasyExcel…sheet()方法之前作用域是整个workBook的所有sheet，之后针对单个sheet。</li></ul><h3 id="2、读取时的注解"><a href="#2、读取时的注解" class="headerlink" title="2、读取时的注解"></a>2、读取时的注解</h3><h4 id="ExcelProperty"><a href="#ExcelProperty" class="headerlink" title="@ExcelProperty"></a>@ExcelProperty</h4><p><strong>使用位置</strong>：标准作用在成员变量上</p><p><strong>可选属性：</strong></p><table><thead><tr><th>属性名</th><th align="left">含义</th><th>说明</th></tr></thead><tbody><tr><td>index</td><td align="left">对应Excel表中的列数</td><td>默认-1，建议指定时从0开始</td></tr><tr><td>value</td><td align="left">对应Excel表中的列头</td><td></td></tr><tr><td>converter</td><td align="left">成员变量转换器</td><td>自定义转换器需要实Converter接口</td></tr></tbody></table><p><strong>使用效果</strong>：index属性可以指定当前字段对应excel中的哪一列，可以根据列名value去匹配，也可以不写。</p><p>如果不使用@ExcelProperty注解，成员变量从上到下的顺序，对应表格中从左到右的顺序；</p><p><strong>使用建议：</strong>要么全部不写，要么全部用index，要么全部用value去匹配，尽量不要三个混着用。</p><p><strong>代码演示：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 修改成员变量顺序读取Excel表格</span></span><br><span class="line"><span class="comment">// 2. 修改index属性值读取Excel表格</span></span><br><span class="line"><span class="comment">// 3. 修改value属性值读取Excel表格</span></span><br></pre></td></tr></table></figure><h4 id="ExcelIgnore"><a href="#ExcelIgnore" class="headerlink" title="@ExcelIgnore"></a>@ExcelIgnore</h4><p>标注在成员变量上，默认所有字段都会和excel去匹配，加了这个注解会忽略该字段</p><p> <strong>代码演示：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. 忽略id成员变量值读取Excel表格</span></span><br></pre></td></tr></table></figure><h4 id="DateTimeFormat"><a href="#DateTimeFormat" class="headerlink" title="@DateTimeFormat"></a>@DateTimeFormat</h4><p>标注在成员变量上，日期转换，代码中用<code>String类型的成员变量</code>去接收<code>excel中日期格式的数据</code>会调用这个注解。里面的<code>value</code>参照<code>java.text.SimpleDateFormat</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5. 按照指定的格式写入Excel内容</span></span><br></pre></td></tr></table></figure><h4 id="NumberFormat"><a href="#NumberFormat" class="headerlink" title="@NumberFormat"></a>@NumberFormat</h4><p>标注在成员变量上，数字转换，代码中用<code>String类型的成员变量</code>去接收<code>excel数字格式的数据</code>会调用这个注解。里面的<code>value</code>参照<code>java.text.DecimalFormat</code></p><h4 id="ExcelIgnoreUnannotated"><a href="#ExcelIgnoreUnannotated" class="headerlink" title="@ExcelIgnoreUnannotated"></a>@ExcelIgnoreUnannotated</h4><p>标注在类上。</p><p>不标注该注解时，默认类中所有成员变量都会参与读写，无论是否在成员变量上加了<code>@ExcelProperty</code> 的注解。</p><p>标注该注解后，类中的成员变量如果没有标注<code>@ExcelProperty</code> 注解将不会参与读写。</p><h3 id="3、-读取时通用参数"><a href="#3、-读取时通用参数" class="headerlink" title="3、 读取时通用参数"></a>3、 读取时通用参数</h3><p><code>ReadWorkbook</code>,<code>ReadSheet</code> 都会有的参数，如果为空，默认使用上级。</p><ul><li><p><code>converter</code> 转换器，默认加载了很多转换器。也可以自定义。</p></li><li><p><code>readListener</code> 监听器，在读取数据的过程中会不断的调用监听器。</p></li><li><p><code>headRowNumber</code> 指定需要读表格的 列头行数。默认有一行头，也就是认为第二行开始起为数据。</p></li><li><p><code>head</code> 与<code>clazz</code>二选一。读取文件头对应的列表，会根据列表匹配数据。建议使用class，就是文件中每一行数据对应的代码中的实体类型。</p></li><li><p><code>clazz</code> 与<code>head</code>二选一。读取文件的头对应的class，也可以使用注解。如果两个都不指定，则会读取全部数据。</p></li><li><p><code>autoTrim</code> 字符串、表头等数据自动trim</p></li><li><p><code>password</code> 读的时候是否需要使用密码</p></li></ul><h3 id="4、ReadWorkbook（工作簿对象）参数"><a href="#4、ReadWorkbook（工作簿对象）参数" class="headerlink" title="4、ReadWorkbook（工作簿对象）参数"></a>4、ReadWorkbook（工作簿对象）参数</h3><ul><li><code>excelType</code> 当前excel的类型，读取时会自动判断，无需设置。</li><li><code>inputStream</code> 与<code>file</code>二选一。建议使用file。</li><li><code>file</code> 与<code>inputStream</code>二选一。读取文件的文件。</li><li><code>autoCloseStream</code> 自动关闭流。</li><li><code>readCache</code> 默认小于5M用 内存，超过5M会使用 <code>EhCache</code>，不建议使用这个参数。</li><li><code>useDefaultListener</code> <code>@since 2.1.4</code> 默认会加入<code>ModelBuildEventListener</code> 来帮忙转换成传入<code>class</code>的对象，设置成<code>false</code>后将不会协助转换对象，自定义的监听器会接收到<code>Map&lt;Integer,CellData&gt;</code>对象，如果还想继续接听到<code>class</code>对象，请调用<code>readListener</code>方法，加入自定义的<code>beforeListener</code>、 <code>ModelBuildEventListener</code>、 自定义的<code>afterListener</code>即可。</li></ul><h3 id="5、ReadSheet（工作表对象）参数"><a href="#5、ReadSheet（工作表对象）参数" class="headerlink" title="5、ReadSheet（工作表对象）参数"></a>5、ReadSheet（工作表对象）参数</h3><ul><li><code>sheetNo</code> 需要读取Sheet的编号，建议使用这个来指定读取哪个Sheet</li><li><code>sheetName</code> 根据名字去匹配Sheet，excel 2003不支持根据名字去匹配</li></ul><h3 id="6、写入时的注解注解"><a href="#6、写入时的注解注解" class="headerlink" title="6、写入时的注解注解"></a>6、写入时的注解注解</h3><h4 id="ExcelProperty-1"><a href="#ExcelProperty-1" class="headerlink" title="@ExcelProperty"></a>@ExcelProperty</h4><p><strong>使用位置</strong>：标准作用在成员变量上</p><p><strong>可选属性：</strong></p><table><thead><tr><th>属性名</th><th align="left">含义</th><th>说明</th></tr></thead><tbody><tr><td>index</td><td align="left">对应Excel表中的列数</td><td>默认-1，指定时建议从0开始</td></tr><tr><td>value</td><td align="left">对应Excel表中的列头</td><td></td></tr><tr><td>converter</td><td align="left">成员变量转换器</td><td>自定义转换器需要实Converter接口</td></tr></tbody></table><p><strong>使用效果</strong>：<code>index</code> 指定写到第几列，如果不指定则根据成员变量位置排序；</p><p>​                     <code>value</code>指定写入的列头，如果不指定则使用成员变量的名字作为列头；</p><p>​                    如果要设置复杂的头，可以为value指定多个值。</p><p><strong>代码演示：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5. 为《杭州黑马学员表.xlsx》文件中学生信息设置一个统一的表头“杭州黑马学员信息表”</span></span><br></pre></td></tr></table></figure><h4 id="其他注解："><a href="#其他注解：" class="headerlink" title="其他注解："></a>其他注解：</h4><p>基本和读取时一致</p><ul><li><p>@ContentRowHeight()    标注在类上或属性上，指定内容行高</p></li><li><p>@HeadRowHeight()  标注在类上或属性上，指定列头行高</p></li><li><p>@ColumnWidth() 标注在类上或属性上，指定列宽</p></li><li><p>ExcelIgnore` 默认所有字段都会写入excel，这个注解会忽略这个字段</p></li><li><p><code>DateTimeFormat</code> 日期转换，将<code>Date</code>写到excel会调用这个注解。里面的<code>value</code>参照<code>java.text.SimpleDateFormat</code></p></li><li><p><code>NumberFormat</code> 数字转换，用<code>Number</code>写excel会调用这个注解。里面的<code>value</code>参照<code>java.text.DecimalFormat</code></p></li><li><p><code>ExcelIgnoreUnannotated</code> 默认不加 <code>ExcelProperty</code> 的注解的都会参与读写，加了不会参与</p></li></ul><h3 id="7、写入时通用参数"><a href="#7、写入时通用参数" class="headerlink" title="7、写入时通用参数"></a>7、写入时通用参数</h3><p><code>WriteWorkbook</code>、<code>WriteSheet</code>都会有的参数，如果为空，默认使用上级。</p><ul><li><p><code>converter</code> 转换器，默认加载了很多转换器。也可以自定义。</p></li><li><p><code>writeHandler</code> 写的处理器。可以实现<code>WorkbookWriteHandler</code>,<code>SheetWriteHandler</code>,<code>RowWriteHandler</code>,<code>CellWriteHandler</code>，在写入excel的不同阶段会调用，对使用者透明不可见。</p></li><li><p><code>relativeHeadRowIndex</code> 距离多少行后开始。也就是开头空几行</p></li><li><p><code>needHead</code> 是否导出头</p></li><li><p><code>head</code> 与<code>clazz</code>二选一。写入文件的头列表，建议使用class。</p></li><li><p><code>clazz</code> 与<code>head</code>二选一。写入文件的头对应的class，也可以使用注解。</p></li><li><p><code>autoTrim</code>  字符串、表头等数据自动trim</p></li></ul><h3 id="8、WriteWorkbook（工作簿对象）参数"><a href="#8、WriteWorkbook（工作簿对象）参数" class="headerlink" title="8、WriteWorkbook（工作簿对象）参数"></a>8、WriteWorkbook（工作簿对象）参数</h3><ul><li><p><code>excelType</code> 当前excel的类型，默认为<code>xlsx</code></p></li><li><p><code>outputStream</code> 与<code>file</code>二选一。写入文件的流</p></li><li><p><code>file</code> 与<code>outputStream</code>二选一。写入的文件</p></li><li><p><code>templateInputStream</code> 模板的文件流</p></li><li><p><code>templateFile</code> 模板文件</p></li><li><p><code>autoCloseStream</code> 自动关闭流。</p></li><li><p><code>password</code>  写的时候是否需要使用密码</p></li><li><p><code>useDefaultStyle</code> 写的时候是否是使用默认头</p></li></ul><h3 id="9、WriteSheet（工作表对象）参数"><a href="#9、WriteSheet（工作表对象）参数" class="headerlink" title="9、WriteSheet（工作表对象）参数"></a>9、WriteSheet（工作表对象）参数</h3><ul><li><p><code>sheetNo</code> 需要写入的编号。默认0</p></li><li><p><code>sheetName</code> 需要些的Sheet名称，默认同sheetNo</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> EasyExcel SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>eight</title>
      <link href="/2021/02/02/eight/"/>
      <url>/2021/02/02/eight/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><p>大概是看《夏洛特烦恼》时，最让自己感动到的歌吧。</p>    <div id="aplayer-PFchuaCD" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="139377" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#C20C0C"    ></div><hr><p>不知天高地厚时候的自己，也曾立志要改变世界吧。</p>    <div id="aplayer-jHpyTdmf" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="41664790" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#C20C0C"    ></div><hr><p>像是一些已经忘却的回忆从脑海深处一点点渗了出来。</p>    <div id="aplayer-FlkfcGcb" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="407761576" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#C20C0C"    ></div><hr>    <div id="aplayer-ABmCYUXX" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="557584656" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#C20C0C"    ></div><blockquote><p>无限大な梦のあとの 在无限大的梦想后面<br>何もない世の中じゃ 这什么也没有的世界<br>そうさ爱しい 亲爱的<br>想いも负けそうになるけど 即使我对你的思念比不上你<br>Stay しがちなイメージだらけの 就算有一双满身停留影像的<br>頼りない翼でも 不可靠翅膀<br>きっと飞べるさ 也一定能高飞的</p></blockquote><hr><p>让人充满希望</p>    <div id="aplayer-XfVnDPJV" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="28287132" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#C20C0C"    ></div><hr><p>To Be Continued.</p>]]></content>
      
      
      <categories>
          
          <category> 分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>那个名叫猴子的大佬</title>
      <link href="/2020/07/14/%E9%82%A3%E4%B8%AA%E5%90%8D%E5%8F%AB%E7%8C%B4%E5%AD%90%E7%9A%84%E5%A4%A7%E4%BD%AC/"/>
      <url>/2020/07/14/%E9%82%A3%E4%B8%AA%E5%90%8D%E5%8F%AB%E7%8C%B4%E5%AD%90%E7%9A%84%E5%A4%A7%E4%BD%AC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><p align="left"><font color=#FF7D00 size=3 face="黑体">&nbsp&nbsp&nbsp&nbsp猴子者曰齐天大圣也，算了直接来吧。<br>&nbsp&nbsp&nbsp&nbsp佳齐大佬的作品，被我用来装点门面，正好想试一下七牛云的感觉如何，那就来吧。<br>&nbsp&nbsp&nbsp&nbsp(σﾟ∀ﾟ)σ..:*☆哎哟不错哦</font></p><h2 id="《自序：殊言》"><a href="#《自序：殊言》" class="headerlink" title="《自序：殊言》"></a>《自序：殊言》</h2><a class="btn-beautify button--animated orange" href="http://searesource.top/%E3%80%8A%E8%87%AA%E5%BA%8F%EF%BC%9A%E6%AE%8A%E8%A8%80%E3%80%8B.doc" title="点击下载"><i class="far fa-hand-point-right fa-fw"></i> 点击下载 </a><h2 id="死生结"><a href="#死生结" class="headerlink" title="死生结"></a>死生结</h2><a class="btn-beautify button--animated orange" href="http://searesource.top/%E6%AD%BB%E7%94%9F%E7%BB%93.doc" title="点击下载"><i class="far fa-hand-point-right fa-fw"></i> 点击下载 </a><h2 id="流年措：原来你也在这里"><a href="#流年措：原来你也在这里" class="headerlink" title="流年措：原来你也在这里"></a>流年措：原来你也在这里</h2><a class="btn-beautify button--animated orange" href="http://searesource.top/%E6%B5%81%E5%B9%B4%E6%8E%AA%EF%BC%9A%E5%8E%9F%E6%9D%A5%E4%BD%A0%E4%B9%9F%E5%9C%A8%E8%BF%99%E9%87%8C.doc" title="点击下载"><i class="far fa-hand-point-right fa-fw"></i> 点击下载 </a><p>没错，我就是想偷懒了~</p>]]></content>
      
      
      <categories>
          
          <category> 文学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>几个比较好用的网站推荐</title>
      <link href="/2020/07/02/0702_%E5%87%A0%E4%B8%AA%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BD%91%E7%AB%99/"/>
      <url>/2020/07/02/0702_%E5%87%A0%E4%B8%AA%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BD%91%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><p align="left"><font color=#FF7D00 size=3 face="黑体">&nbsp&nbsp&nbsp&nbsp其实老早就想写一点东西，自从寒假做大创项目开始就陆陆续续的自己解决好多问题，原来并不都是那么的难倒是收获了许多东西。博客本身这个东西挺好，至少可以让自己知道有些东西总是要做一做的。<br>&nbsp&nbsp&nbsp&nbsp闲话不多说，直接步入正题。这次主要是一些比较常用网站的推荐，基本上可以满足日常的需要的~<br>&nbsp&nbsp&nbsp&nbsp(σﾟ∀ﾟ)σ..:*☆哎哟不错哦</font></p><h2 id="RemoveBG"><a href="#RemoveBG" class="headerlink" title="RemoveBG"></a>RemoveBG</h2><p>这是一个超牛逼的抠图网站，中文翻译过来的意思就是移除背景。</p><p>网站虽然是英文，但是大陆用户不影响正常访问。用谷歌浏览器+谷歌翻译扩展程序，机翻成中文，一点都不影响使用。</p><p><a href="https://baideye.com/wp-content/uploads/2020/02/beepress1-1581332505.jpg" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://baideye.com/wp-content/uploads/2020/02/beepress1-1581332505.jpg" alt="GtVgoT.jpg"></a></p><p>点击首页得[Select Photo]即可上传图片，移除背景。随便找个图，来感受下它有多牛逼吧！</p><p><a href="https://baideye.com/wp-content/uploads/2020/02/beepress6-1581332505.jpg" target="_blank" rel="noopener" title="markdown"><img src= "/img/loading.gif" data-src="https://baideye.com/wp-content/uploads/2020/02/beepress6-1581332505.jpg" alt=""></a></p><p>点击[Edit]，还可以在线编辑、替换背景。</p><p><a href="https://baideye.com/wp-content/uploads/2020/02/beepress4-1581332505.jpg" target="_blank" rel="noopener" title="markdown"><img src= "/img/loading.gif" data-src="https://baideye.com/wp-content/uploads/2020/02/beepress4-1581332505.jpg" alt=""></a></p><a class="btn-beautify button--animated orange" href="/www.remove.bg" title="点击进入_RemoveBG"><i class="far fa-hand-point-right fa-fw"></i> 点击进入_RemoveBG </a><h2 id="iLovePDF"><a href="#iLovePDF" class="headerlink" title="iLovePDF"></a>iLovePDF</h2><p>诶嘿，没错了就像这个名字一样，这是一个在线PDF操作器，优点嘛太多了，比如免费、功能齐全(几乎所有的操作都可以使用)</p><p><img src= "/img/loading.gif" data-src="https://s1.ax1x.com/2020/07/03/NOUNUe.png" alt="NOUNUe.png"></p><p>这个改成中文这个也很棒啊</p><a class="btn-beautify button--animated orange" href="https://www.ilovepdf.com/" target="_blank" rel="noopener" title="点击进入_iLovePDF"><i class="far fa-hand-point-right fa-fw"></i> 点击进入_iLovePDF </a><h2 id="中国传统色"><a href="#中国传统色" class="headerlink" title="中国传统色"></a>中国传统色</h2><p>设计图片、做视频的时候，都需要配色。无奈自己又不是学设计的，也不知道怎么搭配颜色，人家那颜色一看高级，自己弄出来的就是红蓝黄乡村非主流。</p><p>中国传统色这个网站，是一个很好用的配色网站。里面的颜色都很高级，有点中国风的味道。</p><p>颜色旁边有RGB值，可以直接复制，粘贴到PS或其他作图工具里边。</p><p><a href="https://baideye.com/wp-content/uploads/2020/02/beepress1-1581332505.jpg" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://baideye.com/wp-content/uploads/2020/02/beepress8-1581332542.jpg" alt="GtVgoT.jpg"></a></p><a class="btn-beautify button--animated orange" href="http://zhongguose.com" target="_blank" rel="noopener" title="点击进入_中国传统色"><i class="far fa-hand-point-right fa-fw"></i> 点击进入_中国传统色 </a><h2 id="图片压缩"><a href="#图片压缩" class="headerlink" title="图片压缩"></a>图片压缩</h2><p>平时整一个文档插入一个图片动不动都是好几M，太大了怎么办？这时候能把图片压缩就比较棒了啊。当然做前端也少不了和图片打招呼，这个网站操作简单，直接上传图片就能下载压缩好的图片，而且图片质量相当好，非常值得推荐。</p><p><a href="https://s1.ax1x.com/2020/07/02/NLynTP.md.png" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://s1.ax1x.com/2020/07/02/NLynTP.md.png" alt="GtVgoT.jpg"></a></p><a class="btn-beautify button--animated orange" href="https://tinypng.com/" target="_blank" rel="noopener" title="点击进入_tinypng"><i class="far fa-hand-point-right fa-fw"></i> 点击进入_tinypng </a><h2 id="孟坤工具箱"><a href="#孟坤工具箱" class="headerlink" title="孟坤工具箱"></a>孟坤工具箱</h2><p>这是一个在线工具箱，功能截图放在这里啦，自己尝试一下吧，上面还有一些开放源码可以学习借鉴一下。</p><p><a href="https://s1.ax1x.com/2020/07/03/NL6aDA.md.png" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://s1.ax1x.com/2020/07/03/NL6aDA.md.png" alt="GtVgoT.jpg"></a></p><a class="btn-beautify button--animated orange" href="http://tool.mkblog.cn/" target="_blank" rel="noopener" title="点击进入_孟坤工具箱"><i class="far fa-hand-point-right fa-fw"></i> 点击进入_孟坤工具箱 </a><h2 id="杨小杰工具箱"><a href="#杨小杰工具箱" class="headerlink" title="杨小杰工具箱"></a>杨小杰工具箱</h2><p>和上面类似啦</p><p><a href="https://s1.ax1x.com/2020/07/03/NL6T8U.md.png" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://s1.ax1x.com/2020/07/03/NL6T8U.md.png" alt="GtVgoT.jpg"></a></p><a class="btn-beautify button--animated orange" href="https://tools.yum6.cn/" target="_blank" rel="noopener" title="点击进入_杨小杰工具箱"><i class="far fa-hand-point-right fa-fw"></i> 点击进入_杨小杰工具箱 </a><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>毕竟还不熟悉，写的比较简陋，就这样吧~</p>]]></content>
      
      
      <categories>
          
          <category> 常用推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《测试标签外挂》</title>
      <link href="/2020/06/30/%E6%A0%87%E7%AD%BE/"/>
      <url>/2020/06/30/%E6%A0%87%E7%AD%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><div class="note default">            <p>default 提示塊標籤</p>          </div><div class="note primary no-icon">            <p>primary 提示塊標籤</p>          </div><div class="note success">            <p>success 提示塊標籤</p>          </div><div class="note info">            <p>info 提示塊標籤</p>          </div><div class="note warning">            <p>warning 提示塊標籤</p>          </div><div class="note danger">            <p>danger 提示塊標籤</p>          </div>]]></content>
      
      
      <categories>
          
          <category> 文学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《宋词简史》</title>
      <link href="/2020/04/04/0404_%E5%AE%8B%E8%AF%8D%E7%AE%80%E5%8F%B2/"/>
      <url>/2020/04/04/0404_%E5%AE%8B%E8%AF%8D%E7%AE%80%E5%8F%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><!-- 如果你想在你的外链卡片上显示一些信息，你可以写在  more   前，它会被当作摘要显示。 --><p align="left"><font color=#FF7D00 size=3 face="黑体">&nbsp&nbsp&nbsp&nbsp我看青山多妩媚，料青山看我应如是。终宋一代，刑不及大夫，少了些武功，却多了些文治，似乎这样才能孕育出宋词这颗璀璨的明珠吧！崖山之后无华夏，300余年宋词史业已曲终，奈何弦断有谁听啊?<br>&nbsp&nbsp&nbsp&nbsp(σﾟ∀ﾟ)σ..:*☆哎哟不错哦</font></p><a id="more"></a><p><strong><p align="center"><font size=3 face="黑体">（一）</font></p></strong></p><blockquote></blockquote><P>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp五代十国的最后一代叫后周，非常厉害；可惜皇帝命短，留下个七岁小朋友继位。<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp有一天，朝廷里有人大喊：啊！契丹人来砸场子了！<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp一个保卫科长叫赵匡胤，立刻带着一票兄弟出去迎敌。大家走到一个叫陈桥的地方，弟兄们哗的一声掏出一件黄橙橙的龙袍，二话不说就往赵科长身上披，后来赵匡胤一脸便秘的穿上龙袍，于公元960年正式建立了宋朝。看来，历史的经验早就告诉我们，得到黄圣衣的男人果然最牛逼！<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp赵匡胤是真的牛逼，只可惜跟弟弟喝酒喝死了，谁又能想到连死都可以整出一个“烛光斧影”的成语来呢？看来宋朝之所以能够成为古代文化巅峰也就不足为奇了。没办法，谁让人家的基因强大呢？此时，富二代李煜默默地走过，不住感叹：“也许这就是历史吧！”所谓的南唐后主不过是昙花一现，很快就被赵光义灭掉啦，他不但接管了李煜国家，还接管了李煜的漂亮老婆，江山美人都让人给占了，逼得李煜只能发微博表达郁闷：</p><blockquote><p><strong><p align="center">《虞美人》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp春花秋月何时了？往事知多少。小楼昨夜又东风，故国不堪回首月明中。</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp雕栏玉砌应犹在，只是朱颜改。问君能有几多愁？恰似一江春水向东流。</p></blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元975年，南唐灭亡，后主李煜开始了为期三年的俘虏生涯。<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这三年对于李煜来说，是无比痛苦的，但是对于词的历史来说，又是无比幸运的。<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp若没有这三年，就没有“垂泪对宫娥”，没有“一晌贪欢”，没有“剪不断理还乱”，就不会有“变伶工之词为士大夫之词”。<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp宋词的开篇，也就没有了那样一个凄美奇绝的前奏。<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元978年，七夕这日，41岁的李煜永远停了笔，他所有的爱恨情仇，全都和着那杯毒酒，一饮而尽；被誉为“千古词帝”的他“变伶工之词为士大夫之词”，也揭开了宋词的开篇，用一江春水，汇成了宋词的浩瀚海洋，万古一碧，荡涤天涯！<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp现在！宋词！来了！It’s SongChi Style!<br><br></p><p><strong><p align="center"><font size=3 face="黑体">（二）</font></p></strong></p><blockquote></blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp像是入夜前的黄昏，在宋初的几十年间，词坛还很荒凉，星空虽辽阔，星辰却寥落！后人很难记住寇准、林俌这些名字。但是要相信当你瞄准月亮时，即使失落也仍然在星河之间，而夜空中最亮的星——柳永也终会出现。</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1018年，金銮殿上的宋仁宗在一份试卷上亲手批注：且填词去，何要浮名？就这样，一代才子词人失去了指点江山的机会，走进市井，自嘲：奉旨填词柳三变。白衣卿相至此混迹舞榭歌楼，烟花巷陌，在另一个领域如痴如醉！</p><blockquote><p><strong><p align="center">《八声甘州》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp对潇潇暮雨洒江天，一番洗清秋。渐霜风凄紧，关河冷落，残照当楼。是处红衰翠减，苒苒物华休。唯有长江水，无语东流。</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp不忍登高临远，望故乡渺邈，归思难收。叹年来踪迹，何事苦淹留？想佳人妆楼颙望，误几回、天际识归舟。争知我，倚栏杆处，正恁凝愁！</p><p><strong><p align="center">《蝶恋花》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp伫倚危楼风细细，望极春愁，黯黯生天际。草色烟光残照里，无言谁会凭阑意?</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp拟把疏狂图一醉，对酒当歌，强乐还无味。衣带渐宽终不悔，为伊消得人憔悴。</p><p><strong><p align="center">《鹤冲天》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp黄金榜上，偶失龙头望。明代暂遗贤，如何向？未遂风去便，争不恣游狂荡？何须论得丧。才子词人，自是白衣卿相。</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp烟花巷陌，依约丹青屏障。幸有意中人，堪寻访。且恁偎红倚翠，风流事，平生畅。青春都一晌。忍把浮名，换了浅斟低唱！</p></blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp凡有井水处，皆能歌柳词，没人记得那年黄金榜上状元的姓名，只有那个失意的白衣男子，永远定格在时间的记忆中，任凭历史长河逢高浪急，他的身影，始终不曾淡去。</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1004年，柳永还没开始他的第一次考试，却有个传说中的“别人家的孩子”已经以14岁稚龄中举授官，他叫晏殊。作为太平时期的太平宰相，他的词就像他的一生一样四平八稳，虽有些哀愁，但无负能量。<blockquote><p><strong><p align="center">《蝶恋花·槛菊愁烟兰泣露》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp槛菊愁烟兰泣露，罗幕轻寒，燕子双飞去。明月不谙离恨苦，斜光到晓穿朱户。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp昨夜西风凋碧树，独上高楼，望尽天涯路。欲寄彩笺兼尺素，山长水阔知何处！<p><strong><p align="center">《破阵子·春景》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp燕子来时新社，梨花落后清明。池上碧苔三四点，叶底黄鹂一两声。日长飞絮轻。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp巧笑东邻女伴，采桑径里逢迎。疑怪昨宵春梦好，元是今朝斗草赢。笑从双脸生。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp后人王国维曾引用“昨夜西风凋碧树，独上高楼，望尽天涯路”喻之为“古之成大事业、大学问者”必经的第一境界。这不由得让我们想起站在巨人肩膀上的牛顿。其实，晏殊的儿子晏几道也是这样。出生于1038年的晏几道口中肯定含着金光闪闪的钥匙，父亲在政坛上一路高歌凯奏，成为太平宰相，他自己同样十几岁就中了进士。只可惜晏几道在享受了若干年的声色犬马之后，沦为落魄公子，让人不胜唏嘘。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp夫天行有常，不为尧存，不为桀亡。也许是冥冥中自有天意，晏几道本来可以有更好的选择，父亲晏殊留下来的关系链，足够他做出一番成就了，但，他不愿意，他更愿意在另一个天地中继续前行！<blockquote><p><strong><p align="center">《临江仙》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp梦后楼台高锁，酒醒帘幕低垂。去年春恨却来时。落花人独立，微雨燕双飞。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp记得小蘋初见，两重心字罗衣。琵琶弦上说相思。当时明月在，曾照彩云归。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp比起柳永相对无奈的“奉旨填词”，似乎晏几道才是那个把填词当成事业的人，嗟乎！“梦魂惯得无拘检，又踏杨花过谢桥”这句一出，连程颐这样古板的理学家，都得笑着给小晏点个赞。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp如果说晏殊是太平宰相，一生四平八稳，那么范仲淹的一生则显得波澜壮阔。范仲淹幼年丧父，直到公元1015年方得苦读及第，我们对他的印象大多来自《岳阳楼记》里面的“先天下之忧而忧，后天下之乐而乐”，其实他所留给我们的远不止如此。他是文人士大夫，却屯田西北大漠，安保西部边陲；他是高居庙堂的宰相，却处江湖之远，心忧天下苍生。<blockquote><p><strong><p align="center">《渔家傲·秋思》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp塞下秋来风景异，衡阳雁去无留意。四面边声连角起，千嶂里，长烟落日孤城闭。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp浊酒一杯家万里，燕然未勒归无计。羌管悠悠霜满地，人不寐，将军白发征夫泪。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp1043年，范仲淹出任参知政事，发起“庆历新政”。不久后，新政受挫，他被贬出京，历知邠州、邓州、杭州、青州。1052年，改知颍州，范仲淹扶疾上任，于途中逝世，谥号“文正”。范文正公走了，却留下了为数不多的词来记录他的某些片段，永远留在文字中，滋养后人！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1030年，新科进士的队伍里，站着一个24岁的青年。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他叫欧阳修，那时候没人知道，他会成为一代重臣，主修《新唐书》、独撰《新五代史》，倡导“诗文革新运动”……<blockquote><p><strong><p align="center">《浪淘沙·把酒祝东风》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp把酒祝东风，且共从容。垂杨紫陌洛城东。总是当时携手处，游遍芳丛。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp聚散苦匆匆，此恨无穷。今年花胜去年红。可惜明年花更好，知与谁同？</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp宋人总是愿意把文体分得很清楚，诗文用来“干正事”，词是消遣。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp所以欧阳修这样一位大神写起词来，可以“庭院深深深几许”，可以“月上柳梢头，人约黄昏后”，可以“笑问双鸳鸯字、怎生书”。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp醉翁之意不在酒，在乎山水之间也！他即有“如今薄宦老天涯”的感慨，也有“文章太守，挥毫万字，一饮千钟”的豪迈。但他毕竟不是一心填词的柳永和晏几道。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他受李煜的影响，扩大了词的抒情功能，用词抒发人生感受；他借鉴民歌的写法，让词变得更加通俗活泼……<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp在苏轼等人登场之前，欧阳修作为一个靠谱的前辈，给他们打下了非常良好的基础。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp遍观宋代政坛，刑不及谏大夫，文人虽权高却仍能名重一时，这可比唐代之李白、杜甫的命运要好的太多了。范仲淹如是，晏殊如是，王安石亦如是！时间来到公元1042年，王安石进士及第。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp现在我们说到这个人，会马上想起他的“春风又绿江南岸，明月何时照我还”，“不畏浮云遮望眼，自缘身在最高层”“千门万户曈曈日，总把新桃换旧符”。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他的诗，在语文课本里出现的频率真的很高！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp可是词呢？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他一生只有29首词作，数量远不如诗文，却也有惊艳的作品，比如这首《桂枝香》。<blockquote><p><strong><p align="center">《桂枝香·金陵怀古》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp登临送目，正故国晚秋，天气初肃。千里澄江似练，翠峰如簇。归帆去棹残阳里，背西风，酒旗斜矗。彩舟云淡，星河鹭起，画图难足。(归帆 一作：征帆)<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp念往昔，繁华竞逐，叹门外楼头，悲恨相续。千古凭高对此，谩嗟荣辱。六朝旧事随流水，但寒烟衰草凝绿。至今商女，时时犹唱，后庭遗曲。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp王安石被宋人称作“妖人”，惊艳的才学，特立独行的生活风格，似乎放在那里他都能躺赢,可偏偏他总是自讨苦吃！进士及第后，不做京官，偏要扎身基层，任宰相之后，更是以一人之力推动着“熙宁变法”的进行，旨在富国强兵！身居高位的王安石，有着更高的眼界、更开阔的性情怀抱，可以从历史的角度去看到兴亡教训，境界高远，人所不及！叹然！奈何“为与士大夫治天下，非与百姓治天下”（天下是士大夫治理的天下，不是老百姓治理的天下啊）！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他被那个时代的人不断抹黑，但人们唯一不敢抹黑的就是王安石的才华！就连老对头苏轼见了这首词，都要叹一句：此老乃野狐精也——这个老狐狸呀，能把历史写得这样透彻，算他了不起（你行你牛逼）！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp苏轼和王安石在政治上怼了一辈子，但在文学的道路上，他们却互相佩服着，这也算宋代文坛独有的特色了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp也许正因为有了这样包容度极高的文化氛围，才能产生这么多优秀的词作吧！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1057年，负责科举的主考官欧阳修对一个二十岁出头的青年下了这样的结论：“（吾靠）此人可谓善读书，善用书，他日文章必独步天下！”<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp其实何止文章呢！此人的诗词、书法竟然无一不精，能治大国，可烹小鲜，堪称不世出的“奇才”与“全才”。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这个人名字，叫苏轼。<blockquote><p><strong><p align="center">《江城子·乙卯正月二十日夜记梦》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp十年生死两茫茫，不思量，自难忘。千里孤坟，无处话凄凉。纵使相逢应不识，尘满面，鬓如霜。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp夜来幽梦忽还乡，小轩窗，正梳妆。相顾无言，惟有泪千行。料得年年肠断处，明月夜，短松冈。<p><strong><p align="center">《念奴娇·赤壁怀古》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp大江东去，浪淘尽，千古风流人物。故垒西边，人道是，三国周郎赤壁。乱石穿空，惊涛拍岸，卷起千堆雪。江山如画，一时多少豪杰。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp遥想公瑾当年，小乔初嫁了，雄姿英发。羽扇纶巾，谈笑间，樯橹灰飞烟灭。(樯橹一作：强虏)故国神游，多情应笑我，早生华发。人生如梦，一尊还酹江月。<p><strong><p align="center">《水调歌头·明月几时有》</p></strong></p><p><em>丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。</em></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp明月几时有？把酒问青天。不知天上宫阙，今夕是何年。我欲乘风归去，又恐琼楼玉宇，高处不胜寒。起舞弄清影，何似在人间(何似一作：何时；又恐一作：惟/唯恐)<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp转朱阁，低绮户，照无眠。不应有恨，何事长向别时圆？人有悲欢离合，月有阴晴圆缺，此事古难全。但愿人长久，千里共婵娟。<p><strong><p align="center">《蝶恋花·春景》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp花褪残红青杏小。燕子飞时，绿水人家绕。枝上柳绵吹又少。天涯何处无芳草！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp墙里秋千墙外道。墙外行人，墙里佳人笑。笑渐不闻声渐悄。多情却被无情恼。<p><strong><p align="center">《念奴娇·中秋》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp凭高眺远，见长空万里，云无留迹。桂魄飞来，光射处，冷浸一天秋碧。玉宇琼楼，乘鸾来去，人在清凉国。江山如画，望中烟树历历。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp我醉拍手狂歌，举杯邀月，对影成三客。起舞徘徊风露下，今夕不知何夕？便欲乘风，翻然归去，何用骑鹏翼。水晶宫里，一声吹断横笛。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp在他以前，词坛只有“婉约”一派。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp似乎是理所应当，词就该是柔软的，细腻的，是“晓风残月”的清冷，是“独上高楼”的孤寂，就算久居西北大漠的范仲淹写的“将军白发征夫泪”，也没有成为时代主流。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp苏轼也会写婉约词，而且写得很好，一句“十年生死两茫茫，不思量，自难忘”在千百年后依然让人闻之落泪。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp但历史注定要让他站在婉约的对立面，举起一杆大旗，上书“豪放”二字，墨迹淋漓，“举杯邀月”，使人禁不住放声长啸。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp“千里共婵娟”洗尽了离愁别绪，“大江东去”则开拓了全新的境界。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp从此，歌唱“晓风残月”的十七八岁女郎身边，又多了铁板铜琶的关西大汉。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp在苏轼一生的颠沛流离之中，宋词，终于奏响了史上的最强音，动次打次！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1087年，苏轼引荐了一个叫秦观的太学博士。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp后来，这个秦观成为了“苏门四学士”之一，在词学上成就极高。<blockquote><p><strong><p align="center">《鹊桥仙·纤云弄巧》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp纤云弄巧，飞星传恨，银汉迢迢暗度。金风玉露一相逢，便胜却人间无数。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp柔情似水，佳期如梦，忍顾鹊桥归路。两情若是久长时，又岂在朝朝暮暮。<p><strong><p align="center">《满庭芳·山抹微云》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp山抹微云，天连衰草，画角声断谯门。暂停征棹，聊共引离尊。多少蓬莱旧事，空回首、烟霭纷纷。斜阳外，寒鸦万点，流水绕孤村。(万点 一作：数点)<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp销魂。当此际，香囊暗解，罗带轻分。谩赢得、青楼薄幸名存。此去何时见也，襟袖上、空惹啼痕。伤情处，高城望断，灯火已黄昏。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp苏轼称他有“屈宋之才”，拿自家学生与屈原宋玉作比，未免偏心，却也证明秦观确实有本事。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp有趣的是，老师是豪放派的开创者，秦观这个得意门生却是婉约派的掌门人。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp“柔情似水，佳期如梦”“无边丝雨细如愁”，秦观的词，大约就像贾宝玉口中的女儿家，是水做的骨肉吧！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp一首《满庭芳》，让秦观被称为“山抹微云学士”。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp那个时候，没有可以给自己贴标签的社交系统，没有“男神”这样的称呼。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp一句“山抹微云学士”，却是秦观在朋友圈里，最闪亮的名片。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1100年，秦观过世；公元1101年，苏轼过世。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这时的词坛，多少有些青黄不接。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这一首《青玉案》的横空出世，让“闲愁”的境界变得无比开阔，仿佛是一针强心剂，掀起了一波唱和的风潮，所以“苏门四学士”之一的黄庭坚专门写诗感叹：解道江南断肠句，只今唯有贺方回！<blockquote><p><strong><p align="center">《青玉案·凌波不过横塘路》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp凌波不过横塘路，但目送、芳尘去。锦瑟华年谁与度？月桥花院，琐窗朱户，只有春知处。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp飞云冉冉蘅皋暮，彩笔新题断肠句。试问闲情都几许？一川烟草，满城风絮，梅子黄时雨。<p><strong><p align="center">《踏莎行》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp杨柳回塘，鸳鸯别浦，绿萍涨断莲舟路。断无蜂蝶慕幽香，红衣脱尽芳心苦。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp返照迎潮，行云带雨，依依似与骚人语：当年不肯嫁春风，无端却被秋风误!</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp贺铸作词，很喜欢给词牌改名。比如他很得意“凌波不过横塘路”这句，便给《青玉案》改名叫了《横塘路》。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这里便要说到词牌的各种别名了，就像荷花、莲花、菡萏、芙蕖傻傻分不清楚一样，词牌的别名也是让人眼花缭乱的。其中一种命名方式就来自名句，但这一般都是后人做的。作者亲自完成这项工作，贺铸绝对是破天荒的第一人。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp在他的词集中，除了自度曲调和传抄失名的词作之外，改名的竟然达121首之多，而且同一个通用调名，在他的集子中也是篇篇异名。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp虽然后人在读贺铸词的时候，难免会嫌弃他“添乱”，却也要感谢他贡献的《芳心苦》《半死桐》这些美妙的名字。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp感谢这另类的玩法，让我们感受到了一些极致的美好。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1105年，宋朝新成立了一个机构——大晟府，负责谱曲作词，这可以说是一个专管宋词的衙门了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp虽然它只存在了短短15年，却催生了一批“大晟词人”。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp与柳永那个自封的“白衣卿相”相比，他们才是正经“奉旨填词”的公务员啊！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这里面的代表人物，就是周邦彦。在野史传说中，他与宋徽宗、李师师之间有一场旷日持久的三角恋。因此得罪了宋徽宗，被踢出京城，在临行时，他写下了这首《兰陵王》。<blockquote><p><strong><p align="center">《兰陵王·柳》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp柳阴直，烟里丝丝弄碧。隋堤上、曾见几番，拂水飘绵送行色。登临望故国，谁识京华倦客？长亭路，年去岁来，应折柔条过千尺。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp闲寻旧踪迹，又酒趁哀弦，灯照离席。梨花榆火催寒食。愁一箭风快，半篙波暖，回头迢递便数驿，望人在天北。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp凄恻，恨堆积！渐别浦萦回，津堠岑寂，斜阳冉冉春无极。念月榭携手，露桥闻笛。沉思前事，似梦里，泪暗滴。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这个词牌据说来自歌颂北齐高长恭的《兰陵王入阵曲》，是雄壮的战歌，却在漫长的时光蹉跎中，演变成了慢词，一唱三叹。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp宋徽宗作为一个文艺皇帝，总觉得天下会填词的就不是坏人，据说听了周邦彦的《兰陵王》之后，他气消了，又把人调了回来。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这一首离别东京汴梁的词，很快就被传唱开来。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp可那个时候谁会想到，不久以后，他们将永远离开这个繁华的城市。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp离开那些瓦肆勾栏、花遮柳护、凤楼龙阁，甚至远离中原。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp离开，那个歌舞升平的北宋王朝。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1126年，宋钦宗靖康元年，金兵攻破汴京；<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1127年，金人俘徽、钦二帝北狩，北宋灭亡。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp靖康之变——历史书上冷冰冰的四个字，却埋葬了167年的繁华，埋葬了生灵涂炭哀鸿遍野，埋葬了“晓风残月”“罗幕轻寒”……<blockquote><p><strong><p align="center">《眼儿媚·玉京曾忆昔繁华》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp玉京曾忆昔繁华。万里帝王家。琼林玉殿，朝喧弦管，暮列笙琶。 <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp花城人去今萧索，春梦绕胡沙。家山何处，忍听羌笛，吹彻梅花。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp有人说，历史不过是一个又一个的轮回——当李煜的“三千里地山河”变成了赵佶的“万里帝王家”，几百年的光阴，仿佛只有一个弹指。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp前世，今生。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp相传赵佶的父亲宋神宗赵顼偶尔到秘书省视察工作的时候，看到了李煜的画像——“见其人物俨雅，再三叹讶”，回去之后，又梦见了那个文采风流的“违命侯”。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp然后，赵佶出生了……<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp末代君王、多才多艺、国破被俘、受尽屈辱……<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp赵佶和李煜，实在有着太多的共同标签。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1135年，饱受折磨的赵佶逝于五国城（今黑龙江省依兰县），那些精致的金石、器皿、书画、诗词等，徒让后人叹息罢了，唉！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1127年有着太多的生离死别，在惨淡的南渡队伍当中，一个中年女子的身影格外醒目，她随身携带的不是金银珠宝，而是十五车书画古物。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp她是李清照，那一年，她43岁。<blockquote><p><strong><p align="center">《声声慢·寻寻觅觅》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp寻寻觅觅，冷冷清清，凄凄惨惨戚戚。乍暖还寒时候，最难将息。三杯两盏淡酒，怎敌他、晚来风急？雁过也，正伤心，却是旧时相识。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp满地黄花堆积。憔悴损，如今有谁堪摘？守着窗儿，独自怎生得黑？梧桐更兼细雨，到黄昏、点点滴滴。这次第，怎一个愁字了得！</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp“倚门回首，却把青梅嗅”的少女时代好像还在昨日，“一种相思，两处闲愁”的闺怨情怀尚在眉梢眼角停留，人，却早已天人相隔，江山，也已风云变幻。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp于是，只能酒入愁肠，听着梧桐细雨，声声催人泪下。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp连用七组叠字，虽然词境依旧婉约，这样的写法却也堪称“豪放”了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp她失去了故乡，又失去了丈夫，却到底，没有失去一颗热爱文字的心，却也只能留下“至今思项羽，不肯过江东”的叹息罢了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1142年，春节前夕。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp39岁的岳飞，再也等不到他的“不惑之年”，带着满腹的疑惑与悲愤，死在了“莫须有”的罪名之下。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp从此，金人再也不怕“岳家军”；从此，昏君奸臣“高枕无忧”；从此，中原父老再也望不到王师的旗帜，直捣黄龙府永成泡影......<blockquote><p><strong><p align="center">《满江红·登黄鹤楼有感》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp遥望中原，荒烟外、许多城郭。想当年、花遮柳护，凤楼龙阁。万岁山前珠翠绕，蓬壶殿里笙歌作。到而今、铁骑满郊畿，风尘恶。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp兵安在？膏锋锷。民安在？填沟壑。叹江山如故，千村寥落。何日请缨提锐旅，一鞭直渡清河洛。却归来、再续汉阳游，骑黄鹤。<p><strong><p align="center">《满江红》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp怒发冲冠，凭阑处、潇潇雨歇。抬望眼、仰天长啸，壮怀激烈。三十功名尘与土，八千里路云和月。莫等闲，白了少年头，空悲切。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp靖康耻，犹未雪；臣子恨，何时灭。驾长车，踏破贺兰山缺。壮志饥餐胡虏肉，笑谈渴饮匈奴血。待从头、收拾旧山河，朝天阙。<p><strong><p align="center">《小重山·昨夜寒蛩不住鸣》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp昨夜寒蛩不住鸣。惊回千里梦，已三更。起来独自绕阶行。人悄悄，帘外月胧明。 <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp白首为功名。旧山松竹老，阻归程。欲将心事付瑶琴。知音少，弦断有谁听？</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp据说，岳飞在那张逼迫他认罪的供状上，只写下了八个大字——天日昭昭！天日昭昭！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp戎马倥偬，横槊赋词，一代儒将，如此下场！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp同一年，宋金达成《绍兴和议》，赵佶的尸骨魂归故里。却再也不会有，玉京繁华！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1154年的进士榜上，群星闪耀。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp张孝祥、杨万里、范成大、虞允文……<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp其实本来还应该有一个更响亮的名字——陆游。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp陆游，他的一生始终郁郁不得志，可悲可叹，年轻时迫于封建礼教“没有子嗣是最大的不孝”，才华横溢的发妻唐婉（初为陆游表妹，后结为夫妻），却因不能生育，最终被赶出家门；陆游心中几多无奈与痛苦，却只能像个哑巴闭口不言。七年后，陆游在禹迹寺南沈园的偶遇唐婉，曾经的发妻早已成为嫁做人妇，悲戚的陆游写下了这首《钗头凤》，唐婉见之，心中同样久久不能平，同做《钗头凤》和之，不久，唐婉病逝！<blockquote><p><strong><p align="center">《钗头凤·红酥手》</p></strong></p><p align="right">陆游</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp红酥手，黄縢酒，满城春色宫墙柳。东风恶，欢情薄。一怀愁绪，几年离索。错、错、错。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp春如旧，人空瘦，泪痕红浥鲛绡透。桃花落，闲池阁。山盟虽在，锦书难托。莫、莫、莫！<p><strong><p align="center">《钗头凤·世情薄》</p></strong></p><p align="center">唐婉</p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp世情薄，人情恶，雨送黄昏花易落。晓风干，泪痕残。欲笺心事，独语斜阑。难，难，难！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp人成各，今非昨，病魂常似秋千索。角声寒，夜阑珊。怕人寻问，咽泪装欢。瞒，瞒，瞒！(装欢 通：妆)</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp爱情上失意的他虽然依旧才华横溢，却始终不曾得到“柳暗花明又一村”的时刻！只因为他在省试的时候恰好排在秦桧的孙子秦埙前面，于是直接被踢出了考生名单，直到秦桧死后才得以入仕，又两度因为主张抗金而被免职。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp可是陆游不怨任何人，他依然爱着这个暗无天日的王朝，终生不渝。<blockquote><p><strong><p align="center">《诉衷情·当年万里觅封侯》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp当年万里觅封侯，匹马戍梁州。关河梦断何处？尘暗旧貂裘。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp胡未灭，鬓先秋，泪空流。此生谁料，心在天山，身老沧洲。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp“北定中原”这四个字，陆游念了一辈子，叹了一辈子。也许，就为了能亲眼看到这一天，他努力地活着，努力地写诗，成了少有的长寿诗人。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他其实不喜欢写词，觉得词是游戏之作，晚年编词集的时候还在序言里“自我批评”。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp然而，楼船夜雪、铁马冰河的边塞情怀只能契合于几百年前的盛唐，在这金粉旖旎、风雨飘摇的南宋，显得是那样的格格不入。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp也许陆游自始至终都知道这一点,但还是不能忘却——心在天山，身老沧州！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1154年那次进士考试，秦桧踢掉陆游之后以为万事大吉，结果他的孙子在殿试时竟然只得了第三名。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp那一年的状元，叫张孝祥，他是唐代诗人张籍的后代，当时年仅22岁。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp豪放一派，上承苏轼，下启辛弃疾，中间过渡的这个人，就是张孝祥。据说他每次写完诗文，都要问问人家：比之东坡何如？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp当时抗金主将张浚读了这首《六州歌头》，为之罢席。<blockquote><p><strong><p align="center">《六州歌头·长淮望断》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp长淮望断，关塞莽然平。征尘暗，霜风劲，悄边声。黯销凝。追想当年事，殆天数，非人力，洙泗上，弦歌地，亦膻腥。隔水毡乡，落日牛羊下，区脱纵横。看名王宵猎，骑火一川明。笳鼓悲鸣。遣人惊。 <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp念腰间箭，匣中剑，空埃蠹，竟何成。时易失，心徒壮，岁将零。渺神京。干羽方怀远，静烽燧，且休兵。冠盖使，纷驰骛，若为情。闻道中原遗老，常南望、翠葆霓旌。使行人到此，忠愤气填膺。有泪如倾。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp张孝祥去世的时候，仅仅37岁，此时辛弃疾还未而立。如果，张孝祥可以活得久一点，会不会与辛弃疾平分秋色，让南宋词坛的光彩增加几分？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp可惜，历史总是没有“如果”二字。<br><br><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1161年，金主完颜亮大举南侵，写下“提兵百万西湖上，立马吴山第一峰”的狂妄诗句，北地遗民奋起反击，组成了声势浩大的起义军。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp虽然再无金人惧怕的岳家军风采，却出了一位接替苏轼的词人——辛弃疾。<blockquote><p><strong><p align="center">《青玉案·元夕》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp东风夜放花千树，更吹落，星如雨。宝马雕车香满路。凤箫声动，玉壶光转，一夜鱼龙舞。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp蛾儿雪柳黄金缕，笑语盈盈暗香去。众里寻他千百度，蓦然回首，那人却在，灯火阑珊处。<p><strong><p align="center">《破阵子·为陈同甫赋壮词以寄之》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp醉里挑灯看剑，梦回吹角连营。八百里分麾下炙，五十弦翻塞外声。沙场秋点兵。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp马作的卢飞快，弓如霹雳弦惊。了却君王天下事，赢得生前身后名。可怜白发生！<p><strong><p align="center">《丑奴儿·书博山道中壁》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp少年不识愁滋味，爱上层楼。爱上层楼，为赋新词强说愁。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp而今识尽愁滋味，欲说还休。欲说还休，却道天凉好个秋。<p><strong><p align="center">《水调歌头·壬子三山被召陈端仁给事饮饯席上作》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp长恨复长恨，裁作短歌行。何人为我楚舞，听我楚狂声？余既滋兰九畹，又树蕙之百亩，秋菊更餐英。门外沧浪水，可以濯吾缨。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp一杯酒，问何似，身后名？人间万事，毫发常重泰山轻。悲莫悲生离别，乐莫乐新相识，儿女古今情。富贵非吾事，归与白鸥盟。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp如果说苏轼是文坛中的不世英杰，那么辛弃疾便是武林中的文章魁首，他是真正在战场上喋血过的，写出的词自有一股杀伐之气。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp“渡江天马南来，几人真是经纶手”，一个23岁的英气青年，竟敢率领五十余骑孤军奋战，直闯五万敌军大营，生擒叛徒，千里归宋，何等的豪迈雄壮，何等的气吞山河！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp可是，一瞬间的惊艳之后，便没人再将他放在心上。偏安一隅的南宋王朝，早已经没有了斗志，于是，几十年来，他一直在这样一个令人绝望的环境中挣扎着，抱着北伐的信念，直到垂垂老矣。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1204年，65岁的辛弃疾在镇江担任知府，壮志未酬，只能怀想着历史上的英雄人物，叹大好河山日渐沦丧，哀生年不遇明珠委尘。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp在一个偏安的时代，想做英雄竟不可得，这是一件多么悲哀的事情。他少年时候是霍去病，有着驾长车，踏破贺兰山缺的远大志向，现在老了，自比廉颇，却有谁来当赵王？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp三年后，辛弃疾过世，临终仍在大喊“杀贼”，也许他依旧在幻想着“醉里挑灯看剑”的豪迈吧？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp然而就如同陆游期盼的“王师北定中原日”终究不会来临一样，这一句垂死的呼喊，再无人回答。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1203年，辛弃疾收到一首词作，调寄《沁园春》，词的大意是这样的：<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp我本来要去拜访您，结果呢，遇见了香山居士、林和靖、苏东坡他们三位跟我游西湖喝酒聊天，您看这么难得的机会，要不我下次再去拜访吧！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp用114个字，塞进了三句对话，化用了三个名句，讲了一个奇幻故事，这样的功力让辛弃疾拍案叫绝。<blockquote><p><strong><p align="center">《沁园春·斗酒彘肩》</p></strong></p><p><em>寄辛承旨。时承旨招，不赴。</em></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp斗酒彘肩，风雨渡江，岂不快哉！被香山居士，约林和靖，与坡仙老，驾勒吾回。坡谓西湖，正如西子，浓抹淡妆临镜台。二公者，皆掉头不顾，只管衔杯。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp白云天竺去来，图画里、峥嵘楼观开。爱东西双涧，纵横水绕；两峰南北，高下云堆。逋曰不然，暗香浮动，争似孤山先探梅。须晴去，访稼轩未晚，且此徘徊。</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这首词的作者叫刘过，字改之。如果你看过《射雕英雄传》里郭靖给杨过（字，改之，取知错就改之意）取名那一段，就会觉得这个名字很熟悉了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp刘过终生布衣，朋友圈却十分高大上，除了辛弃疾之外，还有陆游、陈亮、姜夔等等。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他的作品，自然也有“风雨渡江”“不日四方来贺”等雄壮之语，但一次又一次的失望之后，却只能发出一句“终不似、少年游”的无奈叹息。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这是南宋最后几十年的光景。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这个延续二百多年的王朝，这个曾经令人目眩神迷的繁华王朝，到这里，是真的老了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1176年，“烽火扬州路”发生15年之后，22岁的姜夔路过扬州，自度一曲以悼念逝去的“十里春风”，此曲名为《扬州慢》。<blockquote><p><strong><p align="center">《扬州慢·淮左名都》</p></strong></p><p><em>淳熙丙申至日，予过维扬。夜雪初霁，荠麦弥望。入其城，则四顾萧条，寒水自碧，暮色渐起，戍角悲吟。予怀怆然，感慨今昔，因自度此曲。千岩老人以为有“黍离”之悲也。</em></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp淮左名都，竹西佳处，解鞍少驻初程。过春风十里。尽荠麦青青。自胡马窥江去后，废池乔木，犹厌言兵。渐黄昏，清角吹寒。都在空城。 <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp杜郎俊赏，算而今、重到须惊。纵豆蔻词工，青楼梦好，难赋深情。二十四桥仍在，波心荡、冷月无声。念桥边红药，年年知为谁生。 </blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp宋代的词人很多，但是能谱曲的却少见，前有柳永、周邦彦等人，而现在姜夔接过了他们的笔。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他的《白石道人歌曲》中，有17首自带工尺谱，在大部分词牌曲调失传的今天，这些谱子可以说是宋词界一笔极为宝贵的遗产了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp姜夔是个痴情的性子，对这片残破的河山痴情着，对婉转工丽的词曲痴情着，对心仪的女子痴情着。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp慧极必伤，情深不寿！可叹他命途多舛，半生飘零，晚年更是惨淡不已。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1204年，一场大火波及了半个杭州城，官署、民房多被烧毁，姜夔半生心血化为乌有，从此后，他一边叹息着“少年情事老来悲”，吟唱着“当初不合种相思”，一边为生活奔波。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1221年，姜夔过世，却不知他临终之前，是否看见了淮南的那一片皓月？看见他的燕燕莺莺在缓缓招手？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1251年，杭州涌金门外丰乐楼重建，有人在墙上写了一首《莺啼序》，这是宋词里最长的调子，共四片，240字，差不多相当于两首半《念奴娇》。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这首词惊艳了整个杭州城。<blockquote><p><strong><p align="center">《莺啼序·春晚感怀》</p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp残寒正欺病酒，掩沉香绣户。燕来晚、飞入西城，似说春事迟暮。画船载、清明过却，晴烟冉冉吴宫树。念羁情、游荡随风，化为轻絮。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp十载西湖，傍柳系马，趁娇尘软雾。溯红渐招入仙溪，锦儿偷寄幽素，倚银屏、春宽梦窄，断红湿、歌纨金缕。暝堤空，轻把斜阳，总还鸥鹭。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp幽兰旋老，杜若还生，水乡尚寄旅。别后访、六桥无信，事往花委，瘗玉埋香，几番风雨。长波妒盼，遥山羞黛，渔灯分影春江宿。记当时、短楫桃根渡，青楼仿佛，临分败壁题诗，泪墨惨淡尘土。危亭望极，草色天涯，叹鬓侵半苎。暗点检、离痕欢唾，尚染鲛绡，亸凤迷归，破鸾慵舞。殷勤待写，书中长恨，蓝霞辽海沉过雁。漫相思、弹入哀筝柱。伤心千里江南，怨曲重招，断魂在否？</blockquote><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp作者叫吴文英——号称“词家李商隐”，这个最长的词牌，他一辈子写了三首。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp吴文英的很多作品看起来非常像李商隐的《无题》，读起来很美，解释起来很朦胧。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp所以被后世称为“七宝楼台”，就是说整首词放在那里看起来特别漂亮，但是拆出来单句就完全不知道是在写什么。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp现在看来，这种写法很是超越时代性的，因为有所谓“意识流”的痕迹。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp这一首倒是例外的——“何处合成愁，离人心上秋”，明白如话，即使直接放进现代流行歌曲，也没什么违和感。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp甚至很多人都不知道，这竟然是一句宋词。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp垂柳如丝，却挽不住她飘然远去的裙带。冥冥之中，是不是也在说：天河，终究难挽？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1271年，元朝建立。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp公元1279年，崖山失守，丞相陆秀夫背负小皇帝赵昺蹈海自尽，至此，大宋王朝终于从历史的舞台上，惨淡谢幕。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp关汉卿们已经上场了，元曲、杂剧开始落地生根。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp宋词的生命，还在挣扎中延续着。可是随着南宋遗民的垂垂老去，也渐近尾声。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp山河破碎，如风中飘絮，只能“留取丹心照汗青”，哪里还能孕育出一个奉旨填词的柳三变、铁板铜琶的苏东坡呢？<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp只有刘辰翁，只有张炎，还在低低叹息着“缃帙流离，风鬓三五，能赋词最苦”“写不成书，只寄得、相思一点”……<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp蒋捷，昔日的“樱桃进士”，不得不用那支写过“流光容易把人抛，红了樱桃，绿了芭蕉”的笔，为人写字以求糊口。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp他甚至会去问邻居老农——你家需不需要写本农业生产教科书，老农懒得理他，摇摇手就把他打发走了。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp词人末路！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp三百余年的宋词史，就像蒋捷听了一辈子的这场雨：<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp初时缠绵入骨，中场萧瑟苍茫，临近尾声，则只剩下漫漫长夜中一点一滴的凄冷。<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp雨停了，梦……也就醒了！<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp悲欢离合，不过“无情”二字，而已。</p><p><strong><p align="center"><font size=3 face="黑体">（三）</font></p></strong></p><p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp我看青山多妩媚，料青山看我应如是。终宋一代，刑不及大夫，少了些武功，却多了些文治，似乎这样才能孕育出宋词这颗璀璨的明珠吧！崖山之后无华夏，300余年宋词史业已曲终，奈何弦断有谁听啊？<p><strong><p align="right"><em>时乙亥年六月二十五</em></p></strong></p>]]></content>
      
      
      <categories>
          
          <category> 文学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 传记归纳 </tag>
            
            <tag> 诗词 </tag>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《遇见，在雪垠湖边》</title>
      <link href="/2020/04/02/0402_%E9%9B%AA%E5%9E%A0%E6%B9%96/"/>
      <url>/2020/04/02/0402_%E9%9B%AA%E5%9E%A0%E6%B9%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js"></script><!-- 如果你想在你的外链卡片上显示一些信息，你可以写在  more   前，它会被当作摘要显示。 --><p align="left"><font color=#FF7D00 size=3 face="黑体">这应该算是老妖气小说的开篇之作~(σﾟ∀ﾟ)σ..:*☆哎哟不错哦</font></p><a id="more"></a><hr><p>来了，来了……</p><p>她来了……</p><p>她带着通知书走来了……</p><p>一声突如其来的叫声让昏昏欲睡的木一打了鸡血，“来了来了，好紧张！哪呢？在哪呢？”</p><p>新生报道的第一天，像很多志愿者一样，木一此刻的心情是激动的，虽然这已经不是第一个迎接的小学妹了。</p><p>“学长你好，请问去计算机学院怎么走？”，一个秀丽的身影出现在帐篷旁边。</p><p>“噢，噢，噢噢，原来学妹是计算机学院的小19啊！那什么，我带你去吧。”不知道什么原因，木一竟然呆了一下。</p><p>“嗯，那就谢谢学长了。”，小学妹似乎有点腼腆。</p><p>学长这个称呼很受用，木一十分干练地提起学妹手中的行李箱，微微一笑，偷偷打量了一下旁边的女孩。</p><p>高个子，眼睛大大的，马尾辫一直到达腰间，笑起来时嘴巴大大的，全身都透露出这个年纪应有的气息。</p><p><a href="https://imgchr.com/i/GtVSaT" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://s1.ax1x.com/2020/04/02/GtVSaT.jpg" alt="GtVSaT.jpg"></a></p><p>“可真是漂亮，不如…..”，木一脑袋在飞速的转着。</p><p>离计算机学院尚有些距离，不自觉得两个人开始闲聊起来。</p><p>“我叫木一，木头的木，一二三四的一，现在读大二，河南人……”</p><p> “学妹，你叫什么名字？”</p><p>“学妹，你住哪个宿舍 ？”</p><p>“学妹……”</p><p>木一尽量把自己表现的不是很紧张……</p><p>“学长，你……你太热情了，我不知道该回答哪个问题 。”</p><p>“嘿嘿，不好意思啊，不知道怎么称呼你啊？”</p><p>“叫我阿姝吧，静女其姝的意思。”，阿姝回答道。</p><p>看到阿姝有了回应，木一心里平静了不少，“阿姝啊，我感觉你好文静啊，你平时都喜欢做些什么啊？”</p><p>阿姝皱了皱眉头，打量了下眼前这个人，不过还是回应了他，“也没什么吧，我喜欢摄影和写作，把看到的东西都记录下来，像个记者一样记录着。”</p><p>“这是真的吗？这可是太好了，不如……”</p><p>“不如什么？”，阿姝变得更加警惕了，毕竟开学前就有人跟她说：要防火防盗防学长，现在的学长可坏的很嘞！</p><p>“啊哈哈，没，没什么，我们赶紧走吧。”，30多度的天气仍然没挡的住木一背<br>后出冷汗，太可怕了，差点露馅了，木一心里想。</p><p><a href="https://imgchr.com/i/GtVgoT" target="_blank" rel="noopener"><img src= "/img/loading.gif" data-src="https://s1.ax1x.com/2020/04/02/GtVgoT.jpg" alt="GtVgoT.jpg"></a></p><p>突然，木一停了下来……</p><p>只见他放下手中的行李，拿出了本子，写了起来。</p><p>阿姝顺着他的目光的方向看去，原来清澈的湖里飘着几个垃圾，阿姝总觉得心里很不舒服。</p><p>“这个学长可真是太奇怪了，难道他是在写那些垃圾吗？”阿姝在心里小声低估。</p><p>“学，学长，要不我们走吧，都5分钟了。”</p><p>木一撇了一眼旁边的阿姝，若有所思，咬了下笔头，又写了几行。</p><p>“哎哎哎，好嘞好嘞，马上，再给我一分钟！”木一仿佛心不在焉。</p><p>“好了，我们走吧，刚不好意思啊。”</p><p>往后的路上再没有什么“意外”，只是偶尔有微风吹来，轻轻抚起阿姝的发梢……</p><p>将阿姝送到地方后，木一并没有要马上离开的样子。</p><p>“阿姝，今天能认识你真好，不如……不如我送你个东西吧。”木一说起话来竟然有些吞吞吐吐，声音也小的有些可怜，就像蚊子的嗡嗡声。</p><p>“啊？学长，你在说什么啊？我，我没听清……”</p><p>木一拿出本子，从上面撕下了一页。“很开心认识你，送给你！有缘再见！”，这一刻木一消失的速度真的很快。</p><p>“这个学长真是太奇怪了！”，这个想法在阿姝脑海里出现了不知道多少次。<br>阿姝还是打开了字条，只看到上面写着：</p><blockquote><p><em>我校雪垠湖漂浮垃圾现象严重。为贪图一时便利，许多同学顺手将垃圾袋、塑料瓶扔进湖里，甚至有人将垃圾扔入到湖中央的荷花上。这种行为不仅污染生态环境，破坏景观美感，而且也给清洁人员造成极大困扰。</em></p><p><em>本报将对此现象持续关注，跟踪报道。</em></p></blockquote><p align="right">――学生记者  木一<p><p>下面还有几行小字……</p><p>“阿姝，你说你喜欢成为记者，而我喜欢路上的风，记者，记着！我是学生记者木一，QQ:1760724768~”</p><p>那天阿姝不知道呆了多久，只是过了几天后，木一的QQ列表多了条消息：“学长好，我是未来的学生记者，阿姝！”</p><p>“你终于来了！河南大学报《大学生通讯社》欢迎你……”木一回复道。</p><p>感谢遇见，从此我的身边多了个叫阿姝的姑娘，没错，我就是那个木一……<br>答应我，有机会陪我去桥上吹风可以吗？</p><p align="left"><font color=#FF7D00 size=3 face="黑体">河南大学报《大学生通讯社》欢迎你！</font></p><p><strong><p align="right"><em>ps: 本故事纯属虚构</em></p></strong></p>]]></content>
      
      
      <categories>
          
          <category> 文学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
